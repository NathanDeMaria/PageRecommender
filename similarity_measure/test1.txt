
<!-- saved from url=(0051)http://neuralnetworksanddeeplearning.com/chap6.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><div class="line-gutter-backdrop"></div><table><tbody><tr><td class="line-number" value="1"></td><td class="line-content"><span class="html-doctype">&lt;!DOCTYPE html&gt;</span></td></tr><tr><td class="line-number" value="2"></td><td class="line-content"><span class="html-tag">&lt;html <span class="html-attribute-name">lang</span>="<span class="html-attribute-value">en</span>"&gt;</span></td></tr><tr><td class="line-number" value="3"></td><td class="line-content"><span class="html-comment">&lt;!-- Produced from a LaTeX source file.  Note that the production is done --&gt;</span></td></tr><tr><td class="line-number" value="4"></td><td class="line-content"><span class="html-comment">&lt;!-- by a very rough-and-ready (and buggy) script, so the HTML and other  --&gt;</span></td></tr><tr><td class="line-number" value="5"></td><td class="line-content"><span class="html-comment">&lt;!-- code is quite ugly!  Later versions should be better.                --&gt;</span></td></tr><tr><td class="line-number" value="6"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">charset</span>="<span class="html-attribute-value">utf-8</span>"&gt;</span></td></tr><tr><td class="line-number" value="7"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">citation_title</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">Neural Networks and Deep Learning</span>"&gt;</span></td></tr><tr><td class="line-number" value="8"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">citation_author</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">Nielsen, Michael A.</span>"&gt;</span></td></tr><tr><td class="line-number" value="9"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">citation_publication_date</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">2015</span>"&gt;</span></td></tr><tr><td class="line-number" value="10"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">citation_fulltext_html_url</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">http://neuralnetworksanddeeplearning.com</span>"&gt;</span></td></tr><tr><td class="line-number" value="11"></td><td class="line-content">    <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">citation_publisher</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">Determination Press</span>"&gt;</span></td></tr><tr><td class="line-number" value="12"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">icon</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/nnadl_favicon.ICO">nnadl_favicon.ICO</a>" /&gt;</span></td></tr><tr><td class="line-number" value="13"></td><td class="line-content">    <span class="html-tag">&lt;title&gt;</span>Neural networks and deep learning<span class="html-tag">&lt;/title&gt;</span></td></tr><tr><td class="line-number" value="14"></td><td class="line-content">    <span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/assets/jquery.min.js">assets/jquery.min.js</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="15"></td><td class="line-content">    <span class="html-tag">&lt;script <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/x-mathjax-config</span>"&gt;</span></td></tr><tr><td class="line-number" value="16"></td><td class="line-content">      MathJax.Hub.Config({</td></tr><tr><td class="line-number" value="17"></td><td class="line-content">        tex2jax: {inlineMath: [['$','$']]},</td></tr><tr><td class="line-number" value="18"></td><td class="line-content">        "HTML-CSS": </td></tr><tr><td class="line-number" value="19"></td><td class="line-content">          {scale: 92},</td></tr><tr><td class="line-number" value="20"></td><td class="line-content">        TeX: { equationNumbers: { autoNumber: "AMS" }}});</td></tr><tr><td class="line-number" value="21"></td><td class="line-content">    <span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="22"></td><td class="line-content">    <span class="html-tag">&lt;script <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/javascript</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML</a>"&gt;</span><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="23"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="24"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="25"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/assets/style.css">assets/style.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="26"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/assets/pygments.css">assets/pygments.css</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>"&gt;</span></td></tr><tr><td class="line-number" value="27"></td><td class="line-content">    <span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">http://code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css</a>"&gt;</span></td></tr><tr><td class="line-number" value="28"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="29"></td><td class="line-content"><span class="html-tag">&lt;style&gt;</span></td></tr><tr><td class="line-number" value="30"></td><td class="line-content">/* Adapted from */</td></tr><tr><td class="line-number" value="31"></td><td class="line-content">/* https://groups.google.com/d/msg/mathjax-users/jqQxrmeG48o/oAaivLgLN90J, */</td></tr><tr><td class="line-number" value="32"></td><td class="line-content">/* by David Cervone */</td></tr><tr><td class="line-number" value="33"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="34"></td><td class="line-content">@font-face {</td></tr><tr><td class="line-number" value="35"></td><td class="line-content">    font-family: 'MJX_Math';</td></tr><tr><td class="line-number" value="36"></td><td class="line-content">    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); /* IE9 Compat Modes */</td></tr><tr><td class="line-number" value="37"></td><td class="line-content">    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot?iefix') format('eot'),</td></tr><tr><td class="line-number" value="38"></td><td class="line-content">    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff')  format('woff'),</td></tr><tr><td class="line-number" value="39"></td><td class="line-content">    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf')  format('opentype'),</td></tr><tr><td class="line-number" value="40"></td><td class="line-content">    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/svg/MathJax_Math-Italic.svg#MathJax_Math-Italic') format('svg');</td></tr><tr><td class="line-number" value="41"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="42"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="43"></td><td class="line-content">@font-face {</td></tr><tr><td class="line-number" value="44"></td><td class="line-content">    font-family: 'MJX_Main';</td></tr><tr><td class="line-number" value="45"></td><td class="line-content">    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); /* IE9 Compat Modes */</td></tr><tr><td class="line-number" value="46"></td><td class="line-content">    src: url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot?iefix') format('eot'),</td></tr><tr><td class="line-number" value="47"></td><td class="line-content">    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff')  format('woff'),</td></tr><tr><td class="line-number" value="48"></td><td class="line-content">    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf')  format('opentype'),</td></tr><tr><td class="line-number" value="49"></td><td class="line-content">    url('http://cdn.mathjax.org/mathjax/latest/fonts/HTML-CSS/TeX/svg/MathJax_Main-Regular.svg#MathJax_Main-Regular') format('svg');</td></tr><tr><td class="line-number" value="50"></td><td class="line-content">}</td></tr><tr><td class="line-number" value="51"></td><td class="line-content"><span class="html-tag">&lt;/style&gt;</span></td></tr><tr><td class="line-number" value="52"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="53"></td><td class="line-content">  <span class="html-tag">&lt;/head&gt;</span></td></tr><tr><td class="line-number" value="54"></td><td class="line-content">  <span class="html-tag">&lt;body&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">header</span>"&gt;</span><span class="html-tag">&lt;h1 <span class="html-attribute-name">class</span>="<span class="html-attribute-value">chapter_number</span>"&gt;</span></td></tr><tr><td class="line-number" value="55"></td><td class="line-content">  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>=""&gt;</span>CHAPTER 6<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h1&gt;</span></td></tr><tr><td class="line-number" value="56"></td><td class="line-content">  <span class="html-tag">&lt;h1 <span class="html-attribute-name">class</span>="<span class="html-attribute-value">chapter_title</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>=""&gt;</span>Deep learning<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h1&gt;</span><span class="html-tag">&lt;/div&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">section</span>"&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc</span>"&gt;</span> </td></tr><tr><td class="line-number" value="57"></td><td class="line-content"><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_title</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/index.html">index.html</a>"&gt;</span>Neural Networks and Deep Learning<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_not_mainchapter</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/about.html">about.html</a>"&gt;</span>What this book is about<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_not_mainchapter</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/exercises_and_problems.html">exercises_and_problems.html</a>"&gt;</span>On the exercises and problems<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>='<span class="html-attribute-value">toc_mainchapter</span>'&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_using_neural_nets_to_recognize_handwritten_digits_reveal</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_reveal</span>" <span class="html-attribute-name">onMouseOver</span>="<span class="html-attribute-value">this.style.borderBottom='1px solid #2A6EA6';</span>" <span class="html-attribute-name">onMouseOut</span>="<span class="html-attribute-value">this.style.borderBottom='0px';</span>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_img_using_neural_nets_to_recognize_handwritten_digits</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/arrow.png">images/arrow.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">15px</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html">chap1.html</a>"&gt;</span>Using neural nets to recognize handwritten digits<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_using_neural_nets_to_recognize_handwritten_digits</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">display: none;</span>"&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_section</span>"&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html#perceptrons">chap1.html#perceptrons</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Perceptrons<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html#sigmoid_neurons">chap1.html#sigmoid_neurons</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Sigmoid neurons<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html#the_architecture_of_neural_networks">chap1.html#the_architecture_of_neural_networks</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>The architecture of neural networks<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html#a_simple_network_to_classify_handwritten_digits">chap1.html#a_simple_network_to_classify_handwritten_digits</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>A simple network to classify handwritten digits<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html#learning_with_gradient_descent">chap1.html#learning_with_gradient_descent</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Learning with gradient descent<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html#implementing_our_network_to_classify_digits">chap1.html#implementing_our_network_to_classify_digits</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Implementing our network to classify digits<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html#toward_deep_learning">chap1.html#toward_deep_learning</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Toward deep learning<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="58"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="59"></td><td class="line-content">$('#toc_using_neural_nets_to_recognize_handwritten_digits_reveal').click(function() { </td></tr><tr><td class="line-number" value="60"></td><td class="line-content">   var src = $('#toc_img_using_neural_nets_to_recognize_handwritten_digits').attr('src');</td></tr><tr><td class="line-number" value="61"></td><td class="line-content">   if(src == 'images/arrow.png') {</td></tr><tr><td class="line-number" value="62"></td><td class="line-content">     $("#toc_img_using_neural_nets_to_recognize_handwritten_digits").attr('src', 'images/arrow_down.png');</td></tr><tr><td class="line-number" value="63"></td><td class="line-content">   } else {</td></tr><tr><td class="line-number" value="64"></td><td class="line-content">     $("#toc_img_using_neural_nets_to_recognize_handwritten_digits").attr('src', 'images/arrow.png');</td></tr><tr><td class="line-number" value="65"></td><td class="line-content">   };</td></tr><tr><td class="line-number" value="66"></td><td class="line-content">   $('#toc_using_neural_nets_to_recognize_handwritten_digits').toggle('fast', function() {});  </td></tr><tr><td class="line-number" value="67"></td><td class="line-content">});<span class="html-tag">&lt;/script&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>='<span class="html-attribute-value">toc_mainchapter</span>'&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_how_the_backpropagation_algorithm_works_reveal</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_reveal</span>" <span class="html-attribute-name">onMouseOver</span>="<span class="html-attribute-value">this.style.borderBottom='1px solid #2A6EA6';</span>" <span class="html-attribute-name">onMouseOut</span>="<span class="html-attribute-value">this.style.borderBottom='0px';</span>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_img_how_the_backpropagation_algorithm_works</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/arrow.png">images/arrow.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">15px</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html">chap2.html</a>"&gt;</span>How the backpropagation algorithm works<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_how_the_backpropagation_algorithm_works</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">display: none;</span>"&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_section</span>"&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#warm_up_a_fast_matrix-based_approach_to_computing_the_output_from_a_neural_network">chap2.html#warm_up_a_fast_matrix-based_approach_to_computing_the_output_from_a_neural_network</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Warm up: a fast matrix-based approach to computing the output  from a neural network<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#the_two_assumptions_we_need_about_the_cost_function">chap2.html#the_two_assumptions_we_need_about_the_cost_function</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>The two assumptions we need about the cost function<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#the_hadamard_product_$s_\odot_t$">chap2.html#the_hadamard_product_$s_\odot_t$</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>The Hadamard product, $s \odot t$<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#the_four_fundamental_equations_behind_backpropagation">chap2.html#the_four_fundamental_equations_behind_backpropagation</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>The four fundamental equations behind backpropagation<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#proof_of_the_four_fundamental_equations_(optional)">chap2.html#proof_of_the_four_fundamental_equations_(optional)</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Proof of the four fundamental equations (optional)<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#the_backpropagation_algorithm">chap2.html#the_backpropagation_algorithm</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>The backpropagation algorithm<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#the_code_for_backpropagation">chap2.html#the_code_for_backpropagation</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>The code for backpropagation<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#in_what_sense_is_backpropagation_a_fast_algorithm">chap2.html#in_what_sense_is_backpropagation_a_fast_algorithm</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>In what sense is backpropagation a fast algorithm?<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#backpropagation_the_big_picture">chap2.html#backpropagation_the_big_picture</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Backpropagation: the big picture<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="68"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="69"></td><td class="line-content">$('#toc_how_the_backpropagation_algorithm_works_reveal').click(function() { </td></tr><tr><td class="line-number" value="70"></td><td class="line-content">   var src = $('#toc_img_how_the_backpropagation_algorithm_works').attr('src');</td></tr><tr><td class="line-number" value="71"></td><td class="line-content">   if(src == 'images/arrow.png') {</td></tr><tr><td class="line-number" value="72"></td><td class="line-content">     $("#toc_img_how_the_backpropagation_algorithm_works").attr('src', 'images/arrow_down.png');</td></tr><tr><td class="line-number" value="73"></td><td class="line-content">   } else {</td></tr><tr><td class="line-number" value="74"></td><td class="line-content">     $("#toc_img_how_the_backpropagation_algorithm_works").attr('src', 'images/arrow.png');</td></tr><tr><td class="line-number" value="75"></td><td class="line-content">   };</td></tr><tr><td class="line-number" value="76"></td><td class="line-content">   $('#toc_how_the_backpropagation_algorithm_works').toggle('fast', function() {});  </td></tr><tr><td class="line-number" value="77"></td><td class="line-content">});<span class="html-tag">&lt;/script&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>='<span class="html-attribute-value">toc_mainchapter</span>'&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_improving_the_way_neural_networks_learn_reveal</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_reveal</span>" <span class="html-attribute-name">onMouseOver</span>="<span class="html-attribute-value">this.style.borderBottom='1px solid #2A6EA6';</span>" <span class="html-attribute-name">onMouseOut</span>="<span class="html-attribute-value">this.style.borderBottom='0px';</span>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_img_improving_the_way_neural_networks_learn</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/arrow.png">images/arrow.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">15px</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html">chap3.html</a>"&gt;</span>Improving the way neural networks learn<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_improving_the_way_neural_networks_learn</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">display: none;</span>"&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_section</span>"&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#the_cross-entropy_cost_function">chap3.html#the_cross-entropy_cost_function</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>The cross-entropy cost function<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization">chap3.html#overfitting_and_regularization</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Overfitting and regularization<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization">chap3.html#weight_initialization</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Weight initialization<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#handwriting_recognition_revisited_the_code">chap3.html#handwriting_recognition_revisited_the_code</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Handwriting recognition revisited: the code<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network's_hyper-parameters">chap3.html#how_to_choose_a_neural_network's_hyper-parameters</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>How to choose a neural network's hyper-parameters?<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques">chap3.html#other_techniques</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Other techniques<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="78"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="79"></td><td class="line-content">$('#toc_improving_the_way_neural_networks_learn_reveal').click(function() { </td></tr><tr><td class="line-number" value="80"></td><td class="line-content">   var src = $('#toc_img_improving_the_way_neural_networks_learn').attr('src');</td></tr><tr><td class="line-number" value="81"></td><td class="line-content">   if(src == 'images/arrow.png') {</td></tr><tr><td class="line-number" value="82"></td><td class="line-content">     $("#toc_img_improving_the_way_neural_networks_learn").attr('src', 'images/arrow_down.png');</td></tr><tr><td class="line-number" value="83"></td><td class="line-content">   } else {</td></tr><tr><td class="line-number" value="84"></td><td class="line-content">     $("#toc_img_improving_the_way_neural_networks_learn").attr('src', 'images/arrow.png');</td></tr><tr><td class="line-number" value="85"></td><td class="line-content">   };</td></tr><tr><td class="line-number" value="86"></td><td class="line-content">   $('#toc_improving_the_way_neural_networks_learn').toggle('fast', function() {});  </td></tr><tr><td class="line-number" value="87"></td><td class="line-content">});<span class="html-tag">&lt;/script&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>='<span class="html-attribute-value">toc_mainchapter</span>'&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_a_visual_proof_that_neural_nets_can_compute_any_function_reveal</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_reveal</span>" <span class="html-attribute-name">onMouseOver</span>="<span class="html-attribute-value">this.style.borderBottom='1px solid #2A6EA6';</span>" <span class="html-attribute-name">onMouseOut</span>="<span class="html-attribute-value">this.style.borderBottom='0px';</span>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_img_a_visual_proof_that_neural_nets_can_compute_any_function</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/arrow.png">images/arrow.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">15px</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap4.html">chap4.html</a>"&gt;</span>A visual proof that neural nets can compute any function<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_a_visual_proof_that_neural_nets_can_compute_any_function</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">display: none;</span>"&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_section</span>"&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap4.html#two_caveats">chap4.html#two_caveats</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Two caveats<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap4.html#universality_with_one_input_and_one_output">chap4.html#universality_with_one_input_and_one_output</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Universality with one input and one output<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap4.html#many_input_variables">chap4.html#many_input_variables</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Many input variables<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap4.html#extension_beyond_sigmoid_neurons">chap4.html#extension_beyond_sigmoid_neurons</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Extension beyond sigmoid neurons<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap4.html#fixing_up_the_step_functions">chap4.html#fixing_up_the_step_functions</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Fixing up the step functions<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap4.html#conclusion">chap4.html#conclusion</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Conclusion<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="88"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="89"></td><td class="line-content">$('#toc_a_visual_proof_that_neural_nets_can_compute_any_function_reveal').click(function() { </td></tr><tr><td class="line-number" value="90"></td><td class="line-content">   var src = $('#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function').attr('src');</td></tr><tr><td class="line-number" value="91"></td><td class="line-content">   if(src == 'images/arrow.png') {</td></tr><tr><td class="line-number" value="92"></td><td class="line-content">     $("#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function").attr('src', 'images/arrow_down.png');</td></tr><tr><td class="line-number" value="93"></td><td class="line-content">   } else {</td></tr><tr><td class="line-number" value="94"></td><td class="line-content">     $("#toc_img_a_visual_proof_that_neural_nets_can_compute_any_function").attr('src', 'images/arrow.png');</td></tr><tr><td class="line-number" value="95"></td><td class="line-content">   };</td></tr><tr><td class="line-number" value="96"></td><td class="line-content">   $('#toc_a_visual_proof_that_neural_nets_can_compute_any_function').toggle('fast', function() {});  </td></tr><tr><td class="line-number" value="97"></td><td class="line-content">});<span class="html-tag">&lt;/script&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>='<span class="html-attribute-value">toc_mainchapter</span>'&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_why_are_deep_neural_networks_hard_to_train_reveal</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_reveal</span>" <span class="html-attribute-name">onMouseOver</span>="<span class="html-attribute-value">this.style.borderBottom='1px solid #2A6EA6';</span>" <span class="html-attribute-name">onMouseOut</span>="<span class="html-attribute-value">this.style.borderBottom='0px';</span>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_img_why_are_deep_neural_networks_hard_to_train</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/arrow.png">images/arrow.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">15px</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap5.html">chap5.html</a>"&gt;</span>Why are deep neural networks hard to train?<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_why_are_deep_neural_networks_hard_to_train</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">display: none;</span>"&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_section</span>"&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap5.html#the_vanishing_gradient_problem">chap5.html#the_vanishing_gradient_problem</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>The vanishing gradient problem<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap5.html#what's_causing_the_vanishing_gradient_problem_unstable_gradients_in_deep_neural_nets">chap5.html#what's_causing_the_vanishing_gradient_problem_unstable_gradients_in_deep_neural_nets</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>What's causing the vanishing gradient problem?  Unstable gradients in deep neural nets<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap5.html#unstable_gradients_in_more_complex_networks">chap5.html#unstable_gradients_in_more_complex_networks</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Unstable gradients in more complex networks<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap5.html#other_obstacles_to_deep_learning">chap5.html#other_obstacles_to_deep_learning</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Other obstacles to deep learning<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="98"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="99"></td><td class="line-content">$('#toc_why_are_deep_neural_networks_hard_to_train_reveal').click(function() { </td></tr><tr><td class="line-number" value="100"></td><td class="line-content">   var src = $('#toc_img_why_are_deep_neural_networks_hard_to_train').attr('src');</td></tr><tr><td class="line-number" value="101"></td><td class="line-content">   if(src == 'images/arrow.png') {</td></tr><tr><td class="line-number" value="102"></td><td class="line-content">     $("#toc_img_why_are_deep_neural_networks_hard_to_train").attr('src', 'images/arrow_down.png');</td></tr><tr><td class="line-number" value="103"></td><td class="line-content">   } else {</td></tr><tr><td class="line-number" value="104"></td><td class="line-content">     $("#toc_img_why_are_deep_neural_networks_hard_to_train").attr('src', 'images/arrow.png');</td></tr><tr><td class="line-number" value="105"></td><td class="line-content">   };</td></tr><tr><td class="line-number" value="106"></td><td class="line-content">   $('#toc_why_are_deep_neural_networks_hard_to_train').toggle('fast', function() {});  </td></tr><tr><td class="line-number" value="107"></td><td class="line-content">});<span class="html-tag">&lt;/script&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>='<span class="html-attribute-value">toc_mainchapter</span>'&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_deep_learning_reveal</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_reveal</span>" <span class="html-attribute-name">onMouseOver</span>="<span class="html-attribute-value">this.style.borderBottom='1px solid #2A6EA6';</span>" <span class="html-attribute-name">onMouseOut</span>="<span class="html-attribute-value">this.style.borderBottom='0px';</span>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_img_deep_learning</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/arrow.png">images/arrow.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">15px</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="./view-source_neuralnetworksanddeeplearning.com_chap6_files/view-source_neuralnetworksanddeeplearning.com_chap6.html">chap6.html</a>"&gt;</span>Deep learning<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">toc_deep_learning</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">display: none;</span>"&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_section</span>"&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#introducing_convolutional_networks">chap6.html#introducing_convolutional_networks</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Introducing convolutional networks<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#convolutional_neural_networks_in_practice">chap6.html#convolutional_neural_networks_in_practice</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Convolutional neural networks in practice<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#the_code_for_our_convolutional_networks">chap6.html#the_code_for_our_convolutional_networks</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>The code for our convolutional networks<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#recent_progress_in_image_recognition">chap6.html#recent_progress_in_image_recognition</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Recent progress in image recognition<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#other_approaches_to_deep_neural_nets">chap6.html#other_approaches_to_deep_neural_nets</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>Other approaches to deep neural nets<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#on_the_future_of_neural_networks">chap6.html#on_the_future_of_neural_networks</a>"&gt;</span><span class="html-tag">&lt;li&gt;</span>On the future of neural networks<span class="html-tag">&lt;/li&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="108"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="109"></td><td class="line-content">$('#toc_deep_learning_reveal').click(function() { </td></tr><tr><td class="line-number" value="110"></td><td class="line-content">   var src = $('#toc_img_deep_learning').attr('src');</td></tr><tr><td class="line-number" value="111"></td><td class="line-content">   if(src == 'images/arrow.png') {</td></tr><tr><td class="line-number" value="112"></td><td class="line-content">     $("#toc_img_deep_learning").attr('src', 'images/arrow_down.png');</td></tr><tr><td class="line-number" value="113"></td><td class="line-content">   } else {</td></tr><tr><td class="line-number" value="114"></td><td class="line-content">     $("#toc_img_deep_learning").attr('src', 'images/arrow.png');</td></tr><tr><td class="line-number" value="115"></td><td class="line-content">   };</td></tr><tr><td class="line-number" value="116"></td><td class="line-content">   $('#toc_deep_learning').toggle('fast', function() {});  </td></tr><tr><td class="line-number" value="117"></td><td class="line-content">});<span class="html-tag">&lt;/script&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_not_mainchapter</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/sai.html">sai.html</a>"&gt;</span>Appendix: Is there a <span class="html-tag">&lt;em&gt;</span>simple<span class="html-tag">&lt;/em&gt;</span> algorithm for intelligence?<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_not_mainchapter</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/acknowledgements.html">acknowledgements.html</a>"&gt;</span>Acknowledgements<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toc_not_mainchapter</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/faq.html">faq.html</a>"&gt;</span>Frequently Asked Questions<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="118"></td><td class="line-content"><span class="html-tag">&lt;hr&gt;</span></td></tr><tr><td class="line-number" value="119"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sidebar_title</span>"&gt;</span>Sponsors<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="120"></td><td class="line-content"><span class="html-tag">&lt;br/&gt;</span></td></tr><tr><td class="line-number" value="121"></td><td class="line-content"><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>='<a class="html-attribute-value html-external-link" target="_blank" href="http://www.ersatz1.com/">http://www.ersatz1.com/</a>'&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/assets/ersatz.png">assets/ersatz.png</a>' <span class="html-attribute-name">width</span>='<span class="html-attribute-value">140px</span>' <span class="html-attribute-name">style</span>="<span class="html-attribute-value">padding: 0px 0px 10px 8px; border-style: none;</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="122"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="123"></td><td class="line-content"><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>='<a class="html-attribute-value html-external-link" target="_blank" href="http://gsquaredcapital.com/">http://gsquaredcapital.com/</a>'&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/assets/gsquared.png">assets/gsquared.png</a>' <span class="html-attribute-name">width</span>='<span class="html-attribute-value">150px</span>' <span class="html-attribute-name">style</span>="<span class="html-attribute-value">padding: 0px 0px 10px 10px; border-style: none;</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="124"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="125"></td><td class="line-content"><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>='<a class="html-attribute-value html-external-link" target="_blank" href="http://www.tineye.com/">http://www.tineye.com</a>'&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/assets/tineye.png">assets/tineye.png</a>' <span class="html-attribute-name">width</span>='<span class="html-attribute-value">150px</span>'</span></td></tr><tr><td class="line-number" value="126"></td><td class="line-content"><span class="html-attribute-name">style</span>="<span class="html-attribute-value">padding: 0px 0px 10px 8px; border-style: none;</span>"&gt;<span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="127"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="128"></td><td class="line-content"><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>='<a class="html-attribute-value html-external-link" target="_blank" href="http://www.visionsmarts.com/">http://www.visionsmarts.com</a>'&gt;</span><span class="html-tag">&lt;img</span></td></tr><tr><td class="line-number" value="129"></td><td class="line-content"><span class="html-attribute-name">src</span>='<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/assets/visionsmarts.png">assets/visionsmarts.png</a>' <span class="html-attribute-name">width</span>='<span class="html-attribute-value">160px</span>' <span class="html-attribute-name">style</span>="<span class="html-attribute-value">padding: 0px 0px</span></td></tr><tr><td class="line-number" value="130"></td><td class="line-content"><span class="html-tag"><span class="html-attribute-value">0px 0px; border-style: none;</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span> <span class="html-tag">&lt;br/&gt;</span> </td></tr><tr><td class="line-number" value="131"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="132"></td><td class="line-content"><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sidebar</span>"&gt;</span>Thanks to all the <span class="html-tag">&lt;a</span></td></tr><tr><td class="line-number" value="133"></td><td class="line-content"><span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/supporters.html">supporters.html</a>"&gt;supporters<span class="html-tag">&lt;/a&gt;</span> who made the book possible.</td></tr><tr><td class="line-number" value="134"></td><td class="line-content">Thanks also to all the contributors to the <span class="html-tag">&lt;a</span></td></tr><tr><td class="line-number" value="135"></td><td class="line-content"><span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/bugfinder.html">bugfinder.html</a>"&gt;Bugfinder Hall of Fame<span class="html-tag">&lt;/a&gt;</span>.  <span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="136"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="137"></td><td class="line-content"><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sidebar</span>"&gt;</span>The book is currently a beta release, and is still</td></tr><tr><td class="line-number" value="138"></td><td class="line-content">under active development.  Please send error reports to</td></tr><tr><td class="line-number" value="139"></td><td class="line-content">mn@michaelnielsen.org.  For other enquiries, please see the <span class="html-tag">&lt;a</span></td></tr><tr><td class="line-number" value="140"></td><td class="line-content"><span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/faq.html">faq.html</a>"&gt;FAQ<span class="html-tag">&lt;/a&gt;</span> first.<span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="141"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="142"></td><td class="line-content"><span class="html-tag">&lt;hr&gt;</span></td></tr><tr><td class="line-number" value="143"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sidebar_title</span>"&gt;</span>Resources<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="144"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="145"></td><td class="line-content"><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sidebar</span>"&gt;</span></td></tr><tr><td class="line-number" value="146"></td><td class="line-content"><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://github.com/mnielsen/neural-networks-and-deep-learning">https://github.com/mnielsen/neural-networks-and-deep-learning</a>"&gt;</span>Code repository<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="147"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="148"></td><td class="line-content"><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sidebar</span>"&gt;</span></td></tr><tr><td class="line-number" value="149"></td><td class="line-content"><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://eepurl.com/BYr9L">http://eepurl.com/BYr9L</a>"&gt;</span>Mailing list for book announcements<span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="150"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="151"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="152"></td><td class="line-content"><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sidebar</span>"&gt;</span></td></tr><tr><td class="line-number" value="153"></td><td class="line-content"><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://eepurl.com/0Xxjb">http://eepurl.com/0Xxjb</a>"&gt;</span>Michael Nielsen's project announcement mailing list<span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="154"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="155"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="156"></td><td class="line-content"><span class="html-tag">&lt;hr&gt;</span></td></tr><tr><td class="line-number" value="157"></td><td class="line-content"><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://michaelnielsen.org/">http://michaelnielsen.org</a>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/assets/Michael_Nielsen_Web_Small.jpg">assets/Michael_Nielsen_Web_Small.jpg</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">160px</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">border-style: none;</span>"/&gt;</span><span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="158"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="159"></td><td class="line-content"><span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sidebar</span>"&gt;</span></td></tr><tr><td class="line-number" value="160"></td><td class="line-content">By <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://michaelnielsen.org/">http://michaelnielsen.org</a>"&gt;</span>Michael Nielsen<span class="html-tag">&lt;/a&gt;</span> / Jul 2015</td></tr><tr><td class="line-number" value="161"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span></td></tr><tr><td class="line-number" value="162"></td><td class="line-content"><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="163"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In the <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap5.html">chap5.html</a>"&gt;</span>last chapter<span class="html-tag">&lt;/a&gt;</span> we learned that deep neuralnetworks are often much harder to train than shallow neural networks.That's unfortunate, since we have good reason to believe that<span class="html-tag">&lt;em&gt;</span>if<span class="html-tag">&lt;/em&gt;</span> we could train deep nets they'd be much more powerful thanshallow nets.  But while the news from the last chapter isdiscouraging, we won't let it stop us.  In this chapter, we'll developtechniques which can be used to train deep networks, and apply them inpractice.  We'll also look at the broader picture, briefly reviewingrecent progress on using deep nets for image recognition, speechrecognition, and other applications.  And we'll take a brief,speculative look at what the future may hold for neural nets, and forartificial intelligence.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The chapter is a long one.  To help you navigate, let's take a tour.The sections are only loosely coupled, so provided you have some basicfamiliarity with neural nets, you can jump to whatever most interestsyou.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#convolutional_networks">#convolutional_networks</a>"&gt;</span>main part of the chapter<span class="html-tag">&lt;/a&gt;</span> is anintroduction to one of the most widely used types of deep network:deep convolutional networks.  We'll work through a detailed example- code and all - of using convolutional nets to solve the problemof classifying handwritten digits from the MNIST data set:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/digits.png">images/digits.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">160px</span>"&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>We'll start our account of convolutional networks with the shallownetworks used to attack this problem earlier in the book.  Throughmany iterations we'll build up more and more powerful networks.  As wego we'll explore many powerful techniques: convolutions, pooling, theuse of GPUs to do far more training than we did with our shallownetworks, the algorithmic expansion of our training data (to reduceoverfitting), the use of the dropout technique (also to reduceoverfitting), the use of ensembles of networks, and others.  Theresult will be a system that offers near-human performance.  Of the10,000 MNIST test images - images not seen during training! - oursystem will classify 9,967 correctly.  Here's a peek at the 33 imageswhich are misclassified.  Note that the correct classification is inthe top right; our program's classification is in the bottom right:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/ensemble_errors.png">images/ensemble_errors.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">580px</span>"&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Many of these are tough even for a human to classify.  Consider, forexample, the third image in the top row.  To me it looks more like a"9" than an "8", which is the official classification.  Ournetwork also thinks it's a "9".  This kind of "error" is at thevery least understandable, and perhaps even commendable.  We concludeour discussion of image recognition with a<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#recent_progress_in_image_recognition">#recent_progress_in_image_recognition</a>"&gt;</span>survey of some of the  spectacular recent progress<span class="html-tag">&lt;/a&gt;</span> using networks (particularlyconvolutional nets) to do image recognition.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The remainder of the chapter discusses deep learning from a broaderand less detailed perspective.  We'll<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#things_we_didn't_cover_but_which_you'll_eventually_want_to_know">#things_we_didn't_cover_but_which_you'll_eventually_want_to_know</a>"&gt;</span>briefly  survey other models of neural networks<span class="html-tag">&lt;/a&gt;</span>, such as recurrent neuralnets and long short-term memory units, and how such models can beapplied to problems in speech recognition, natural languageprocessing, and other areas.  And we'll<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#on_the_future_of_neural_networks">#on_the_future_of_neural_networks</a>"&gt;</span>speculate about the  future of neural networks and deep learning<span class="html-tag">&lt;/a&gt;</span>, ranging from ideaslike intention-driven user interfaces, to the role of deep learning inartificial intelligence.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The chapter builds on the earlier chapters in the book, making use ofand integrating ideas such as backpropagation, regularization, thesoftmax function, and so on.  However, to read the chapter you don'tneed to have worked in detail through all the earlier chapters.  Itwill, however, help to have read <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html">chap1.html</a>"&gt;</span>Chapter 1<span class="html-tag">&lt;/a&gt;</span>, on thebasics of neural networks.  When I use concepts from Chapters 2 to 5,I provide links so you can familiarize yourself, if necessary.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>It's worth noting what the chapter is not.  It's not a tutorial on thelatest and greatest neural networks libraries.  Nor are we going to betraining deep networks with dozens of layers to solve problems at thevery leading edge.  Rather, the focus is on understanding some of thecore principles behind deep neural networks, and applying them in thesimple, easy-to-understand context of the MNIST problem.  Put anotherway: the chapter is not going to bring you right up to the frontier.Rather, the intent of this and earlier chapters is to focus onfundamentals, and so to prepare you to understand a wide range ofcurrent work.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The chapter is currently in beta.  I welcome notification of typos,bugs, minor errors, and major misconceptions.  Please drop me a lineat mn@michaelnielsen.org if you spot such an error.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h3&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">introducing_convolutional_networks</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#introducing_convolutional_networks">#introducing_convolutional_networks</a>"&gt;</span>Introducing convolutional networks<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h3&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In earlier chapters, we taught our neural networks to do a pretty goodjob recognizing images of handwritten digits:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/digits.png">images/digits.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">160px</span>"&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>We did this using networks in which adjacent network layers are fullyconnected to one another.  That is, every neuron in the network isconnected to every neuron in adjacent layers:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/tikz41.png">images/tikz41.png</a>"/&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In particular, for each pixel in the input image, we encoded thepixel's intensity as the value for a corresponding neuron in the inputlayer.  For the $28 \times 28$ pixel images we've been using, thismeans our network has $784$ ($= 28 \times 28$) input neurons.  We thentrained the network's weights and biases so that the network's outputwould - we hope! - correctly identify the input image: '0', '1','2', ..., '8', or '9'.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Our earlier networks work pretty well: we've<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#98percent">chap3.html#98percent</a>"&gt;</span>obtained a classification accuracy better  than 98 percent<span class="html-tag">&lt;/a&gt;</span>, using training and test data from the<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html#learning_with_gradient_descent">chap1.html#learning_with_gradient_descent</a>"&gt;</span>MNIST handwritten  digit data set<span class="html-tag">&lt;/a&gt;</span>.  But upon reflection, it's strange to use networkswith fully-connected layers to classify images.  The reason is thatsuch a network architecture does not take into account the spatialstructure of the images.  For instance, it treats input pixels whichare far apart and close together on exactly the same footing.  Suchconcepts of spatial structure must instead be inferred from thetraining data.  But what if, instead of starting with a networkarchitecture which is <span class="html-tag">&lt;em&gt;</span>tabula rasa<span class="html-tag">&lt;/em&gt;</span>, we used an architecturewhich tries to take advantage of the spatial structure?  In thissection I describe <span class="html-tag">&lt;em&gt;</span>convolutional neural networks<span class="html-tag">&lt;/em&gt;</span>*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*The  origins of convolutional neural networks go back to the 1970s.  But  the seminal paper establishing the modern subject of convolutional  networks was a 1998 paper,  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf">http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf</a>"&gt;</span>"Gradient-based    learning applied to document recognition"<span class="html-tag">&lt;/a&gt;</span>, by Yann LeCun,  Lon Bottou, Yoshua Bengio, and Patrick Haffner.  LeCun has since made an interesting  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://www.facebook.com/yann.lecun/posts/10152348155137143">https://www.facebook.com/yann.lecun/posts/10152348155137143</a>"&gt;</span>remark<span class="html-tag">&lt;/a&gt;</span>  on the terminology for convolutional nets: "The [biological] neural  inspiration in models like convolutional nets is very  tenuous. That's why I call them 'convolutional nets' not  'convolutional neural nets', and why we call the nodes 'units' and  not 'neurons' ".  Despite this remark, convolutional nets use many  of the same ideas as the neural networks we've studied up to now:  ideas such as backpropagation, gradient descent, regularization,  non-linear activation functions, and so on.  And so we will follow  common practice, and consider them a type of neural network.  I will  use the terms "convolutional neural network" and "convolutional  net(work)" interchangeably.  I will also use the terms  "[artificial] neuron" and "unit" interchangeably.<span class="html-tag">&lt;/span&gt;</span>.  Thesenetworks use a special architecture which is particularly well-adaptedto classify images.  Using this architecture makes convolutionalnetworks fast to train.  This, in turns, helps us train deep,many-layer networks, which are very good at classifying images.Today, deep convolutional networks or some close variant are used inmost neural networks for image recognition.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Convolutional neural networks use three basic ideas: <span class="html-tag">&lt;em&gt;</span>local  receptive fields<span class="html-tag">&lt;/em&gt;</span>, <span class="html-tag">&lt;em&gt;</span>shared weights<span class="html-tag">&lt;/em&gt;</span>, and <span class="html-tag">&lt;em&gt;</span>pooling<span class="html-tag">&lt;/em&gt;</span>.  Let'slook at each of these ideas in turn.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Local receptive fields:<span class="html-tag">&lt;/strong&gt;</span> In the fully-connected layers shownearlier, the inputs were depicted as a vertical line of neurons.  In aconvolutional net, it'll help to think instead of the inputs as a $28\times 28$ square of neurons, whose values correspond to the $28\times 28$ pixel intensities we're using as inputs:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/tikz42.png">images/tikz42.png</a>"/&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>As per usual, we'll connect the input pixels to a layer of hiddenneurons.  But we won't connect every input pixel to every hiddenneuron.  Instead, we only make connections in small, localized regionsof the input image.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>To be more precise, each neuron in the first hidden layer will beconnected to a small region of the input neurons, say, for example, a$5 \times 5$ region, corresponding to $25$ input pixels.  So, for aparticular hidden neuron, we might have connections that look likethis:<span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/tikz43.png">images/tikz43.png</a>"/&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>That region in the input image is called the <span class="html-tag">&lt;em&gt;</span>local receptive  field<span class="html-tag">&lt;/em&gt;</span> for the hidden neuron.  It's a little window on the inputpixels.  Each connection learns a weight.  And the hidden neuronlearns an overall bias as well.  You can think of that particularhidden neuron as learning to analyze its particular local receptivefield.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>We then slide the local receptive field across the entire input image.For each local receptive field, there is a different hidden neuron inthe first hidden layer.  To illustrate this concretely, let's startwith a local receptive field in the top-left corner:<span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/tikz44.png">images/tikz44.png</a>"/&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Then we slide the local receptive field over by one pixel to the right(i.e., by one neuron), to connect to a second hidden neuron:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/tikz45.png">images/tikz45.png</a>"/&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>And so on, building up the first hidden layer.  Note that if we have a$28 \times 28$ input image, and $5 \times 5$ local receptive fields,then there will be $24 \times 24$ neurons in the hidden layer.  Thisis because we can only move the local receptive field $23$ neuronsacross (or $23$ neurons down), before colliding with the right-handside (or bottom) of the input image.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>I've shown the local receptive field being moved by one pixel at atime.  In fact, sometimes a different <span class="html-tag">&lt;em&gt;</span>stride length<span class="html-tag">&lt;/em&gt;</span> is used.For instance, we might move the local receptive field $2$ pixels tothe right (or down), in which case we'd say a stride length of $2$ isused.  In this chapter we'll mostly stick with stride length $1$, butit's worth knowing that people sometimes experiment with differentstride lengths*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*As was done in earlier chapters, if we're  interested in trying different stride lengths then we can use  validation data to pick out the stride length which gives the best  performance.  For more details, see the  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network's_hyper-parameters">chap3.html#how_to_choose_a_neural_network's_hyper-parameters</a>"&gt;</span>earlier    discussion<span class="html-tag">&lt;/a&gt;</span> of how to choose hyper-parameters in a neural network.  The same approach may also be used to choose the size of the local  receptive field - there is, of course, nothing special about using  a $5 \times 5$ local receptive field.  In general, larger local  receptive fields tend to be helpful when the input images are  significantly larger than the $28 \times 28$ pixel MNIST images.<span class="html-tag">&lt;/span&gt;</span>.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Shared weights and biases:<span class="html-tag">&lt;/strong&gt;</span> I've said that each hidden neuronhas a bias and $5 \times 5$ weights connected to its local receptivefield.  What I did not yet mention is that we're going to use the<span class="html-tag">&lt;em&gt;</span>same<span class="html-tag">&lt;/em&gt;</span> weights and bias for each of the $24 \times 24$ hiddenneurons.  In other words, for the $j, k$th hidden neuron, the outputis:<span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">displaced_anchor</span>" <span class="html-attribute-name">name</span>="<span class="html-attribute-value">eqtn125</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span>\begin{eqnarray}   \sigma\left(b + \sum_{l=0}^4 \sum_{m=0}^4  w_{l,m} a_{j+l, k+m} \right).\tag{125}\end{eqnarray}Here, $\sigma$ is the neural activation function - perhaps the<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap1.html#sigmoid_neurons">chap1.html#sigmoid_neurons</a>"&gt;</span>sigmoid function<span class="html-tag">&lt;/a&gt;</span> we used inearlier chapters.  $b$ is the shared value for the bias.  $w_{l,m}$ isa $5 \times 5$ array of shared weights.  And, finally, we use $a_{x,  y}$ to denote the input activation at position $x, y$.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>This means that all the neurons in the first hidden layer detectexactly the same feature*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*I haven't precisely defined the  notion of a feature.  Informally, think of the feature detected by a  hidden neuron as the kind of input pattern that will cause the  neuron to activate: it might be an edge in the image, for instance,  or maybe some other type of shape. <span class="html-tag">&lt;/span&gt;</span>, just at different locations inthe input image.  To see why this makes sense, suppose the weights andbias are such that the hidden neuron can pick out, say, a verticaledge in a particular local receptive field.  That ability is alsolikely to be useful at other places in the image.  And so it is usefulto apply the same feature detector everywhere in the image.  To put itin slightly more abstract terms, convolutional networks are welladapted to the translation invariance of images: move a picture of acat (say) a little ways, and it's still an image of a cat*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*In  fact, for the MNIST digit classification problem we've been  studying, the images are centered and size-normalized.  So MNIST has  less translation invariance than images found "in the wild", so to  speak.  Still, features like edges and corners are likely to be  useful across much of the input space. <span class="html-tag">&lt;/span&gt;</span>.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>For this reason, we sometimes call the map from the input layer to thehidden layer a <span class="html-tag">&lt;em&gt;</span>feature map<span class="html-tag">&lt;/em&gt;</span>.  We call the weights defining thefeature map the <span class="html-tag">&lt;em&gt;</span>shared weights<span class="html-tag">&lt;/em&gt;</span>.  And we call the bias definingthe feature map in this way the <span class="html-tag">&lt;em&gt;</span>shared bias<span class="html-tag">&lt;/em&gt;</span>.  The sharedweights and bias are often said to define a <span class="html-tag">&lt;em&gt;</span>kernel<span class="html-tag">&lt;/em&gt;</span> or<span class="html-tag">&lt;em&gt;</span>filter<span class="html-tag">&lt;/em&gt;</span>.  In the literature, people sometimes use these terms inslightly different ways, and for that reason I'm not going to be moreprecise; rather, in a moment, we'll look at some concrete examples.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The network structure I've described so far can detect just a singlekind of localized feature.  To do image recognition we'll need morethan one feature map.  And so a complete convolutional layer consistsof several different feature maps:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/tikz46.png">images/tikz46.png</a>"/&gt;</span><span class="html-tag">&lt;/center&gt;</span>In the example shown, there are $3$ feature maps.  Each feature map isdefined by a set of $5 \times 5$ shared weights, and a single sharedbias.  The result is that the network can detect $3$ different kindsof features, with each feature being detectable across the entireimage.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>I've shown just $3$ feature maps, to keep the diagram above simple.However, in practice convolutional networks may use more (and perhapsmany more) feature maps.  One of the early convolutional networks,LeNet-5, used $6$ feature maps, each associated to a $5 \times 5$local receptive field, to recognize MNIST digits.  So the exampleillustrated above is actually pretty close to LeNet-5.  In theexamples we develop later in the chapter we'll use convolutionallayers with $20$ and $40$ feature maps.  Let's take a quick peek atsome of the features which are learned*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*The feature maps  illustrated come from the final convolutional network we train, see  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#final_conv">#final_conv</a>"&gt;</span>here<span class="html-tag">&lt;/a&gt;</span>.<span class="html-tag">&lt;/span&gt;</span>:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/net_full_layer_0.png">images/net_full_layer_0.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">400px</span>"&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The $20$ images correspond to $20$ different feature maps (or filters,or kernels).  Each map is represented as a $5 \times 5$ block image,corresponding to the $5 \times 5$ weights in the local receptivefield.  Whiter blocks mean a smaller (typically, more negative)weight, so the feature map responds less to corresponding inputpixels.  Darker blocks mean a larger weight, so the feature mapresponds more to the corresponding input pixels.  Very roughlyspeaking, the images above show the type of features the convolutionallayer responds to.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>So what can we conclude from these feature maps?  It's clear there isspatial structure here beyond what we'd expect at random: many of thefeatures have clear sub-regions of light and dark.  That shows ournetwork really is learning things related to the spatial structure.However, beyond that, it's difficult to see what these featuredetectors are learning.  Certainly, we're not learning (say) the<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://en.wikipedia.org/wiki/Gabor_filter">http://en.wikipedia.org/wiki/Gabor_filter</a>"&gt;</span>Gabor filters<span class="html-tag">&lt;/a&gt;</span> whichhave been used in many traditional approaches to image recognition.In fact, there's now a lot of work on better understanding thefeatures learnt by convolutional networks.  If you're interested infollowing up on that work, I suggest starting with the paper<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1311.2901">http://arxiv.org/abs/1311.2901</a>"&gt;</span>Visualizing and Understanding  Convolutional Networks<span class="html-tag">&lt;/a&gt;</span> by Matthew Zeiler and Rob Fergus (2013).<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>A big advantage of sharing weights and biases is that it greatlyreduces the number of parameters involved in a convolutional network.For each feature map we need $25 = 5 \times 5$ shared weights, plus asingle shared bias. So each feature map requires $26$ parameters.  Ifwe have $20$ feature maps that's a total of $20 \times 26 = 520$parameters defining the convolutional layer.  By comparison, supposewe had a fully connected first layer, with $784 = 28 \times 28$ inputneurons, and a relatively modest $30$ hidden neurons, as we used inmany of the examples earlier in the book.  That's a total of $784\times 30$ weights, plus an extra $30$ biases, for a total of $23,550$parameters.  In other words, the fully-connected layer would have morethan $40$ times as many parameters as the convolutional layer.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Of course, we can't really do a direct comparison between the numberof parameters, since the two models are different in essential ways.But, intuitively, it seems likely that the use of translationinvariance by the convolutional layer will reduce the number ofparameters it needs to get the same performance as the fully-connectedmodel.  That, in turn, will result in faster training for theconvolutional model, and, ultimately, will help us build deep networksusing convolutional layers.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Incidentally, the name <span class="html-tag">&lt;em&gt;</span>convolutional<span class="html-tag">&lt;/em&gt;</span> comes from the fact thatthe operation in Equation <span class="html-tag">&lt;span <span class="html-attribute-name">id</span>="<span class="html-attribute-value">margin_103454852987_reveal</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">equation_link</span>"&gt;</span>(125)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">id</span>="<span class="html-attribute-value">margin_103454852987</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginequation</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">display: none;</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#eqtn125">chap6.html#eqtn125</a>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">padding-bottom: 5px;</span>" <span class="html-attribute-name">onMouseOver</span>="<span class="html-attribute-value">this.style.borderBottom='1px solid #2A6EA6';</span>" <span class="html-attribute-name">onMouseOut</span>="<span class="html-attribute-value">this.style.borderBottom='0px';</span>"&gt;</span>\begin{eqnarray}   \sigma\left(b + \sum_{l=0}^4 \sum_{m=0}^4  w_{l,m} a_{j+l, k+m} \right) \nonumber\end{eqnarray}<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;script&gt;</span>$('#margin_103454852987_reveal').click(function() {$('#margin_103454852987').toggle('slow', function() {});});<span class="html-tag">&lt;/script&gt;</span> is sometimes known as a<span class="html-tag">&lt;em&gt;</span>convolution<span class="html-tag">&lt;/em&gt;</span>.  A little more precisely, people sometimes writethat equation as $a^1 = \sigma(b + w * a^0)$, where $a^1$ denotes theset of output activations from one feature map, $a^0$ is the set ofinput activations, and $*$ is called a convolution operation.  We'renot going to make any deep use of the mathematics of convolutions, soyou don't need to worry too much about this connection.  But it'sworth at least knowing where the name comes from.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Pooling layers:<span class="html-tag">&lt;/strong&gt;</span> In addition to the convolutional layers justdescribed, convolutional neural networks also contain <span class="html-tag">&lt;em&gt;</span>pooling  layers<span class="html-tag">&lt;/em&gt;</span>.  Pooling layers are usually used immediately afterconvolutional layers.  What the pooling layers do is simplify theinformation in the output from the convolutional layer.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In detail, a pooling layer takes each feature map*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*The  nomenclature is being used loosely here.  In particular, I'm using  "feature map" to mean not the function computed by the  convolutional layer, but rather the activation of the hidden neurons  output from the layer.  This kind of mild abuse of nomenclature is  pretty common in the research literature.<span class="html-tag">&lt;/span&gt;</span> output from theconvolutional layer and prepares a condensed feature map.  Forinstance, each unit in the pooling layer may summarize a region of(say) $2 \times 2$ neurons in the previous layer.  As a concreteexample, one common procedure for pooling is known as<span class="html-tag">&lt;em&gt;</span>max-pooling<span class="html-tag">&lt;/em&gt;</span>.  In max-pooling, a pooling unit simply outputs themaximum activation in the $2 \times 2$ input region, as illustrated inthe following diagram:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/tikz47.png">images/tikz47.png</a>"/&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Note that since we have $24 \times 24$ neurons output from theconvolutional layer, after pooling we have $12 \times 12$ neurons.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>As mentioned above, the convolutional layer usually involves more thana  single feature  map.   We  apply max-pooling  to  each feature  mapseparately.   So  if  there  were three  feature  maps,  the  combinedconvolutional and max-pooling layers would look like:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/tikz48.png">images/tikz48.png</a>"/&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>We can think of max-pooling as a way for the network to ask whether agiven feature is found anywhere in a region of the image.  It thenthrows away the exact positional information.  The intuition is thatonce a feature has been found, its exact location isn't as importantas its rough location relative to other features.  A big benefit isthat there are many fewer pooled features, and so this helps reducethe number of parameters needed in later layers.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Max-pooling isn't the only technique used for pooling.  Another commonapproach is known as <span class="html-tag">&lt;em&gt;</span>L2 pooling<span class="html-tag">&lt;/em&gt;</span>.  Here, instead of taking themaximum activation of a $2 \times 2$ region of neurons, we take thesquare root of the sum of the squares of the activations in the $2\times 2$ region.  While the details are different, the intuition issimilar to max-pooling: L2 pooling is a way of condensing informationfrom the convolutional layer.  In practice, both techniques have beenwidely used.  And sometimes people use other types of poolingoperation.  If you're really trying to optimize performance, you mayuse validation data to compare several different approaches topooling, and choose the approach which works best.  But we're notgoing to worry about that kind of detailed optimization.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Putting it all together:<span class="html-tag">&lt;/strong&gt;</span> We can now put all these ideastogether to form a complete convolutional neural network.  It'ssimilar to the architecture we were just looking at, but has theaddition of a layer of $10$ output neurons, corresponding to the $10$possible values for MNIST digits ('0', '1', '2', <span class="html-tag">&lt;em&gt;</span>etc<span class="html-tag">&lt;/em&gt;</span>):<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/tikz49.png">images/tikz49.png</a>"/&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The network begins with $28 \times 28$ input neurons, which are usedto encode the pixel intensities for the MNIST image.  This is thenfollowed by a convolutional layer using a $5 \times 5$ local receptivefield and $3$ feature maps.  The result is a layer of $3 \times 24\times 24$ hidden feature neurons.  The next step is a max-poolinglayer, applied to $2 \times 2$ regions, across each of the $3$ featuremaps.  The result is a layer of $3 \times 12 \times 12$ hidden featureneurons.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The final layer of connections in the network is a fully-connectedlayer.  That is, this layer connects <span class="html-tag">&lt;em&gt;</span>every<span class="html-tag">&lt;/em&gt;</span> neuron from themax-pooled layer to every one of the $10$ output neurons.  Thisfully-connected architecture is the same as we used in earlierchapters.  Note, however, that in the diagram above, I've used asingle arrow, for simplicity, rather than showing all the connections.Of course, you can easily imagine the connections.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>This convolutional architecture is quite different to thearchitectures used in earlier chapters.  But the overall picture issimilar: a network made of many simple units, whose behaviors aredetermined by their weights and biases.  And the overall goal is stillthe same: to use training data to train the network's weights andbiases so that the network does a good job classifying input digits.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In particular, just as earlier in the book, we will train our networkusing stochastic gradient descent and backpropagation.  This mostlyproceeds in exactly the same way as in earlier chapters.  However, wedo need to make few modifications to the backpropagation procedure.The reason is that our earlier <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html">chap2.html</a>"&gt;</span>derivation of  backpropagation<span class="html-tag">&lt;/a&gt;</span> was for networks with fully-connected layers.Fortunately, it's straightforward to modify the derivation forconvolutional and max-pooling layers.  If you'd like to understand thedetails, then I invite you to work through the following problem.  Bewarned that the problem will take some time to work through, unlessyou've really internalized the <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html">chap2.html</a>"&gt;</span>earlier derivation of  backpropagation<span class="html-tag">&lt;/a&gt;</span> (in which case it's easy).<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h4&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">problem_57316</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#problem_57316">#problem_57316</a>"&gt;</span>Problem<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h4&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;li&gt;</span><span class="html-tag">&lt;strong&gt;</span>Backpropagation in a convolutional network<span class="html-tag">&lt;/strong&gt;</span> The core equations  of backpropagation in a network with fully-connected layers  are <span class="html-tag">&lt;span <span class="html-attribute-name">id</span>="<span class="html-attribute-value">margin_103180596035_reveal</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">equation_link</span>"&gt;</span>(BP1)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">id</span>="<span class="html-attribute-value">margin_103180596035</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginequation</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">display: none;</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#eqtnBP1">chap2.html#eqtnBP1</a>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">padding-bottom: 5px;</span>" <span class="html-attribute-name">onMouseOver</span>="<span class="html-attribute-value">this.style.borderBottom='1px solid #2A6EA6';</span>" <span class="html-attribute-name">onMouseOut</span>="<span class="html-attribute-value">this.style.borderBottom='0px';</span>"&gt;</span>\begin{eqnarray}   \delta^L_j = \frac{\partial C}{\partial a^L_j} \sigma'(z^L_j) \nonumber\end{eqnarray}<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;script&gt;</span>$('#margin_103180596035_reveal').click(function() {$('#margin_103180596035').toggle('slow', function() {});});<span class="html-tag">&lt;/script&gt;</span>-<span class="html-tag">&lt;span <span class="html-attribute-name">id</span>="<span class="html-attribute-value">margin_894979031180_reveal</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">equation_link</span>"&gt;</span>(BP4)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">id</span>="<span class="html-attribute-value">margin_894979031180</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginequation</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">display: none;</span>"&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#eqtnBP4">chap2.html#eqtnBP4</a>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">padding-bottom: 5px;</span>" <span class="html-attribute-name">onMouseOver</span>="<span class="html-attribute-value">this.style.borderBottom='1px solid #2A6EA6';</span>" <span class="html-attribute-name">onMouseOut</span>="<span class="html-attribute-value">this.style.borderBottom='0px';</span>"&gt;</span>\begin{eqnarray}    \frac{\partial C}{\partial w^l_{jk}} = a^{l-1}_k \delta^l_j \nonumber\end{eqnarray}<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;script&gt;</span>$('#margin_894979031180_reveal').click(function() {$('#margin_894979031180').toggle('slow', function() {});});<span class="html-tag">&lt;/script&gt;</span>  (<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#backpropsummary">chap2.html#backpropsummary</a>"&gt;</span>link<span class="html-tag">&lt;/a&gt;</span>).  Suppose we have a  network containing a convolutional layer, a max-pooling layer, and a  fully-connected output layer, as in the network discussed above.  How are the equations of backpropagation modified?<span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h3&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">convolutional_neural_networks_in_practice</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#convolutional_neural_networks_in_practice">#convolutional_neural_networks_in_practice</a>"&gt;</span>Convolutional neural networks in practice<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h3&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>We've now seen the core ideas behind convolutional neural networks.Let's look at how they work in practice, by implementing someconvolutional networks, and applying them to the MNIST digitclassification problem.  The program we'll use to do this is called<span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span>, and it's an improved version of the programs<span class="html-tag">&lt;tt&gt;</span>network.py<span class="html-tag">&lt;/tt&gt;</span> and <span class="html-tag">&lt;tt&gt;</span>network2.py<span class="html-tag">&lt;/tt&gt;</span> developed in earlierchapters*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*Note also that <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> incorporates ideas  from the Theano library's documentation on convolutional neural nets  (notably the implementation of  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://deeplearning.net/tutorial/lenet.html">http://deeplearning.net/tutorial/lenet.html</a>"&gt;</span>LeNet-5<span class="html-tag">&lt;/a&gt;</span>), from  Misha Denil's  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://github.com/mdenil/dropout">https://github.com/mdenil/dropout</a>"&gt;</span>implementation of dropout<span class="html-tag">&lt;/a&gt;</span>,  and from <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://colah.github.io/">http://colah.github.io</a>"&gt;</span>Chris Olah<span class="html-tag">&lt;/a&gt;</span>.<span class="html-tag">&lt;/span&gt;</span>.  If you wishto follow along, the code is available<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/network3.py">https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/network3.py</a>"&gt;</span>on  GitHub<span class="html-tag">&lt;/a&gt;</span>.  Note that we'll work through the code for<span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> itself in the next section.  In this section, we'lluse <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> as a library to build convolutional networks.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The programs <span class="html-tag">&lt;tt&gt;</span>network.py<span class="html-tag">&lt;/tt&gt;</span> and <span class="html-tag">&lt;tt&gt;</span>network2.py<span class="html-tag">&lt;/tt&gt;</span> were implementedusing Python and the matrix library Numpy.  Those programs worked fromfirst principles, and got right down into the details ofbackpropagation, stochastic gradient descent, and so on.  But now thatwe understand those details, for <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> we're going to usea machine learning library known as<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://deeplearning.net/software/theano/">http://deeplearning.net/software/theano/</a>"&gt;</span>Theano<span class="html-tag">&lt;/a&gt;</span>*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*See  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.iro.umontreal.ca/~lisa/pointeurs/theano_scipy2010.pdf">http://www.iro.umontreal.ca/&amp;#126;lisa/pointeurs/theano_scipy2010.pdf</a>"&gt;</span>Theano:    A CPU and GPU Math Expression Compiler in Python<span class="html-tag">&lt;/a&gt;</span>, by James  Bergstra, Olivier Breuleux, Frederic Bastien, Pascal Lamblin, Ravzan  Pascanu, Guillaume Desjardins, Joseph Turian, David Warde-Farley,  and Yoshua Bengio (2010).  Theano is also the basis for the popular  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://deeplearning.net/software/pylearn2/">http://deeplearning.net/software/pylearn2/</a>"&gt;</span>Pylearn2<span class="html-tag">&lt;/a&gt;</span> and  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://keras.io/">http://keras.io/</a>"&gt;</span>Keras<span class="html-tag">&lt;/a&gt;</span> neural networks libraries. Other  popular neural nets libraries at the time of this writing include  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://caffe.berkeleyvision.org/">http://caffe.berkeleyvision.org</a>"&gt;</span>Caffe<span class="html-tag">&lt;/a&gt;</span> and  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://torch.ch/">http://torch.ch</a>"&gt;</span>Torch<span class="html-tag">&lt;/a&gt;</span>. <span class="html-tag">&lt;/span&gt;</span>.  Using Theano makes it easy toimplement backpropagation for convolutional neural networks, since itautomatically computes all the mappings involved.  Theano is alsoquite a bit faster than our earlier code (which was written to be easyto understand, not fast), and this makes it practical to train morecomplex networks.  In particular, one great feature of Theano is thatit can run code on either a CPU or, if available, a GPU.  Running on aGPU provides a substantial speedup and, again, helps make it practicalto train more complex networks.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>If you wish to follow along, then you'll need to get Theano running onyour system.  To install Theano, follow the instructions at theproject's <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://deeplearning.net/software/theano/">http://deeplearning.net/software/theano/</a>"&gt;</span>homepage<span class="html-tag">&lt;/a&gt;</span>.The examples which follow were run using Theano 0.6*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*As I  release this chapter, the current version of Theano has changed to  version 0.7.  I've actually rerun the examples under Theano 0.7 and  get extremely similar results to those reported in the text.<span class="html-tag">&lt;/span&gt;</span>.  Somewere run under Mac OS X Yosemite, with no GPU.  Some were run onUbuntu 14.4, with an NVIDIA GPU.  And some of the experiments were rununder both.  To get <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> running you'll need to set the<span class="html-tag">&lt;tt&gt;</span>GPU<span class="html-tag">&lt;/tt&gt;</span> flag to either <span class="html-tag">&lt;tt&gt;</span>True<span class="html-tag">&lt;/tt&gt;</span> or <span class="html-tag">&lt;tt&gt;</span>False<span class="html-tag">&lt;/tt&gt;</span> (as appropriate)in the <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> source.  Beyond that, to get Theano up andrunning on a GPU you may find<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://deeplearning.net/software/theano/tutorial/using_gpu.html">http://deeplearning.net/software/theano/tutorial/using_gpu.html</a>"&gt;</span>the  instructions here<span class="html-tag">&lt;/a&gt;</span> helpful.  There are also tutorials on the web,easily found using Google, which can help you get things working.  Ifyou don't have a GPU available locally, then you may wish to look into<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://aws.amazon.com/ec2/instance-types/">http://aws.amazon.com/ec2/instance-types/</a>"&gt;</span>Amazon Web Services<span class="html-tag">&lt;/a&gt;</span>EC2 G2 spot instances.  Note that even with a GPU the code will takesome time to execute.  Many of the experiments take from minutes tohours to run.  On a CPU it may take days to run the most complex ofthe experiments.  As in earlier chapters, I suggest setting thingsrunning, and continuing to read, occasionally coming back to check theoutput from the code.  If you're using a CPU, you may wish to reducethe number of training epochs for the more complex experiments, orperhaps omit them entirely.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>To get a baseline, we'll start with a shallow architecture using justa single hidden layer, containing $100$ hidden neurons.  We'll trainfor $60$ epochs, using a learning rate of $\eta = 0.1$, a mini-batchsize of $10$, and no regularization.  Here we go*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*Code for the  experiments in this section may be found  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/conv.py">https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/conv.py</a>"&gt;</span>in    this script<span class="html-tag">&lt;/a&gt;</span>.  Note that the code in the script simply duplicates  and parallels the discussion in this section.<span class="html-tag">&lt;br&gt;</span><span class="html-tag">&lt;br&gt;</span>Note also that  throughout the section I've explicitly specified the number of  training epochs.  I've done this for clarity about how we're  training.  In practice, it's worth using  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#early_stopping">chap3.html#early_stopping</a>"&gt;</span>early stopping<span class="html-tag">&lt;/a&gt;</span>, that is,  tracking accuracy on the validation set, and stopping training when  we are confident the validation accuracy has stopped improving.<span class="html-tag">&lt;/span&gt;</span>:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>network3<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="164"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>from<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>network3<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="165"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>from<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>network3<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="166"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>network3<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>load_data_shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>()<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="167"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>10<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="168"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="169"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>784<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="170"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>10<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="171"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SGD<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>60<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="172"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="173"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="174"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>I obtained a best classification accuracy of $97.80$ percent. This isthe classification accuracy on the <span class="html-tag">&lt;tt&gt;</span>test_data<span class="html-tag">&lt;/tt&gt;</span>, evaluated at thetraining epoch where we get the best classification accuracy on the<span class="html-tag">&lt;tt&gt;</span>validation_data<span class="html-tag">&lt;/tt&gt;</span>. Using the validation data to decide when toevaluate the test accuracy helps avoid overfitting to the test data(see this <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#validation_explanation">chap3.html#validation_explanation</a>"&gt;</span>earlier  discussion<span class="html-tag">&lt;/a&gt;</span> of the use of validation data).  We will follow thispractice below.  Your results may vary slightly, since the network'sweights and biases are randomly initialized*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*In fact, in this  experiment I actually did three separate runs training a network  with this architecture.  I then reported the test accuracy which  corresponded to the best validation accuracy from any of the three  runs.  Using multiple runs helps reduce variation in results, which  is useful when comparing many architectures, as we are doing.  I've  followed this procedure below, except where noted.  In practice, it  made little difference to the results obtained.<span class="html-tag">&lt;/span&gt;</span>.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>This $97.80$ percent accuracy is close to the $98.04$ percent accuracyobtained back in <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#chap3_98_04_percent">chap3.html#chap3_98_04_percent</a>"&gt;</span>Chapter 3<span class="html-tag">&lt;/a&gt;</span>,using a similar network architecture and learning hyper-parameters.In particular, both examples used a shallow network, with a singlehidden layer containing $100$ hidden neurons.  Both also trained for$60$ epochs, used a mini-batch size of $10$, and a learning rate of$\eta = 0.1$.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>There were, however, two differences in the earlier network.  First,we <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization">chap3.html#overfitting_and_regularization</a>"&gt;</span>regularized<span class="html-tag">&lt;/a&gt;</span>the earlier network, to help reduce the effects ofoverfitting. Regularizing the current network does improve theaccuracies, but the gain is only small, and so we'll hold off worryingabout regularization until later.  Second, while the final layer inthe earlier network used sigmoid activations and the cross-entropycost function, the current network uses a softmax final layer, and thelog-likelihood cost function.  As<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#softmax">chap3.html#softmax</a>"&gt;</span>explained<span class="html-tag">&lt;/a&gt;</span> in Chapter 3 this isn't a bigchange.  I haven't made this switch for any particularly deep reason- mostly, I've done it because softmax plus log-likelihood cost ismore common in modern image classification networks.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Can we do better than these results using a deeper networkarchitecture?<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Let's begin by inserting a convolutional layer, right at the beginningof the network.  We'll use $5$ by $5$ local receptive fields, a stridelength of $1$, and $20$ feature maps.  We'll also insert a max-poolinglayer, which combines the features using $2$ by $2$ pooling windows.So the overall network architecture looks much like the architecturediscussed in the last section, but with an extra fully-connectedlayer:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/simple_conv.png">images/simple_conv.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">550px</span>"&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In this architecture, we can think of the convolutional and poolinglayers as learning about local spatial structure in the input trainingimage, while the later, fully-connected layer learns at a moreabstract level, integrating global information from across the entireimage.  This is a common pattern in convolutional neural networks.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Let's train such a network, and see how it performs*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*I've  continued to use a mini-batch size of $10$ here.  In fact, as we  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#mini_batch_size">chap3.html#mini_batch_size</a>"&gt;</span>discussed earlier<span class="html-tag">&lt;/a&gt;</span> it may be  possible to speed up training using larger mini-batches.  I've  continued to use the same mini-batch size mostly for consistency  with the experiments in earlier chapters.<span class="html-tag">&lt;/span&gt;</span>:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="175"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="176"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="177"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="178"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="179"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>10<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="180"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SGD<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>60<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="181"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span>   </td></tr><tr><td class="line-number" value="182"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="183"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>That gets us to $98.78$ percent accuracy, which is a considerableimprovement over any of our previous results.  Indeed, we've reducedour error rate by better than a third, which is a great improvement.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In specifying the network structure, I've treated the convolutionaland pooling layers as a single layer.  Whether they're regarded asseparate layers or as a single layer is to some extent a matter oftaste.  <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> treats them as a single layer because itmakes the code for <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> a little more compact.  However,it is easy to modify <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> so the layers can be specifiedseparately, if desired.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h4&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">exercise_683491</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#exercise_683491">#exercise_683491</a>"&gt;</span>Exercise<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h4&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;li&gt;</span> What classification accuracy do you get if you omit the  fully-connected layer, and just use the convolutional-pooling layer  and softmax layer?  Does the inclusion of the fully-connected layer  help?             <span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Can we improve on the $98.78$ percent classification accuracy?<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Let's try inserting a second convolutional-pooling layer.  We'll makethe insertion between the existing convolutional-pooling layer and thefully-connected hidden layer.  Again, we'll use a $5 \times 5$ localreceptive field, and pool over $2 \times 2$ regions.  Let's see whathappens when we train using similar hyper-parameters to before:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="184"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="185"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="186"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="187"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="188"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="189"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="190"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="191"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>10<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="192"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SGD<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>60<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="193"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span>        </td></tr><tr><td class="line-number" value="194"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="195"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Once again, we get an improvement: we're now at $99.06$ percentclassification accuracy!<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>There's two natural questions to ask at this point.  The firstquestion is: what does it even mean to apply a secondconvolutional-pooling layer?  In fact, you can think of the secondconvolutional-pooling layer as having as input $12 \times 12$"images", whose "pixels" represent the presence (or absence) ofparticular localized features in the original input image.  So you canthink of this layer as having as input a version of the original inputimage.  That version is abstracted and condensed, but still has a lotof spatial structure, and so it makes sense to use a secondconvolutional-pooling layer.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>That's a satisfying point of view, but gives rise to a secondquestion.  The output from the previous layer involves $20$ separatefeature maps, and so there are $20 \times 12 \times 12$ inputs to thesecond convolutional-pooling layer.  It's as though we've got $20$separate images input to the convolutional-pooling layer, not a singleimage, as was the case for the first convolutional-pooling layer.  Howshould neurons in the second convolutional-pooling layer respond tothese multiple input images?  In fact, we'll allow each neuron in thislayer to learn from <span class="html-tag">&lt;em&gt;</span>all<span class="html-tag">&lt;/em&gt;</span> $20 \times 5 \times 5$ input neurons inits local receptive field.  More informally: the feature detectors inthe second convolutional-pooling layer have access to <span class="html-tag">&lt;em&gt;</span>all<span class="html-tag">&lt;/em&gt;</span> thefeatures from the previous layer, but only within their particularlocal receptive field*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*This issue would have arisen in the  first layer if the input images were in color.  In that case we'd  have 3 input features for each pixel, corresponding to red, green  and blue channels in the input image.  So we'd allow the feature  detectors to have access to all color information, but only within a  given local receptive field.<span class="html-tag">&lt;/span&gt;</span>.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h4&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">problem_393560</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#problem_393560">#problem_393560</a>"&gt;</span>Problem<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h4&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;li&gt;</span><span class="html-tag">&lt;strong&gt;</span>Using the tanh activation function<span class="html-tag">&lt;/strong&gt;</span> Several times earlier in the  book I've mentioned arguments that the  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#other_models_of_artificial_neuron">chap3.html#other_models_of_artificial_neuron</a>"&gt;</span>tanh    function<span class="html-tag">&lt;/a&gt;</span> may be a better activation function that the sigmoid  function.  We've never acted on those suggestions, since we were  already making plenty of progress with the sigmoid.  But now let's  try some experiments with tanh as our activation function.  Try  training the network with tanh activations in the convolutional and  fully-connected layers*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*Note that you can pass    <span class="html-tag">&lt;tt&gt;</span>activation_fn=tanh<span class="html-tag">&lt;/tt&gt;</span> as a parameter to the    <span class="html-tag">&lt;tt&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/tt&gt;</span> and <span class="html-tag">&lt;tt&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/tt&gt;</span> classes.<span class="html-tag">&lt;/span&gt;</span>.  Begin with the same hyper-parameters as for the sigmoid network, but  train for $20$ epochs instead of $60$.  How well does your network  perform?  What if you continue out to $60$ epochs?  Try plotting the  per-epoch validation accuracies for both tanh- and sigmoid-based  networks, all the way out to $60$ epochs.  If your results are  similar to mine, you'll find the tanh networks train a little  faster, but the final accuracies are very similar.  Can you explain  why the tanh network might train faster?  Can you get a similar  training speed with the sigmoid, perhaps by changing the learning  rate, or doing some rescaling*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*You may perhaps find    inspiration in recalling that $\sigma(z) = (1+\tanh(z/2))/2$.<span class="html-tag">&lt;/span&gt;</span>?  Try a half-dozen iterations on the learning hyper-parameters or  network architecture, searching for ways that tanh may be superior  to the sigmoid. <span class="html-tag">&lt;em&gt;</span>Note: This is an open-ended problem.    Personally, I did not find much advantage in switching to tanh,    although I haven't experimented exhaustively, and perhaps you may    find a way.  In any case, in a moment we will find an advantage in    switching to the rectified linear activation function, and so we    won't go any deeper into the use of tanh.<span class="html-tag">&lt;/em&gt;</span><span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Using rectified linear units:<span class="html-tag">&lt;/strong&gt;</span> The network we've developed atthis point is actually a variant of one of the networks used in theseminal 1998paper*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf">http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf</a>"&gt;</span>"Gradient-based    learning applied to document recognition"<span class="html-tag">&lt;/a&gt;</span>, by Yann LeCun,  Lon Bottou, Yoshua Bengio, and Patrick Haffner  (1998).  There are many differences of detail, but broadly speaking  our network is quite similar to the networks described in the  paper.<span class="html-tag">&lt;/span&gt;</span> introducing the MNIST problem, a network known as LeNet-5.It's a good foundation for further experimentation, and for buildingup understanding and intuition.  In particular, there are many ways wecan vary the network in an attempt to improve our results.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>As a beginning, let's change our neurons so that instead of using asigmoid activation function, we use<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#other_models_of_artificial_neuron">chap3.html#other_models_of_artificial_neuron</a>"&gt;</span>rectified  linear units<span class="html-tag">&lt;/a&gt;</span>.  That is, we'll use the activation function $f(z)\equiv \max(0, z)$.  We'll train for $60$ epochs, with a learning rateof $\eta = 0.03$.  I also found that it helps a little to use some<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#overfitting_and_regularization">chap3.html#overfitting_and_regularization</a>"&gt;</span>l2  regularization<span class="html-tag">&lt;/a&gt;</span>, with regularization parameter $\lambda = 0.1$:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="196"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="197"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="198"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="199"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="200"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="201"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="202"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="203"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="204"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="205"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>10<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="206"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SGD<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>60<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.03<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="207"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lmbda<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="208"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="209"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>I obtained a classification accuracy of $99.23$ percent.  It's amodest improvement over the sigmoid results ($99.06$).  However,across all my experiments I found that networks based on rectifiedlinear units consistently outperformed networks based on sigmoidactivation functions.  There appears to be a real gain in moving torectified linear units for this problem.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>What makes the rectified linear activation function better than thesigmoid or tanh functions?  At present, we have a poor understandingof the answer to this question.  Indeed, rectified linear units haveonly begun to be used widely used in the past few years.  The reasonfor that recent adoption is empirical: a few people tried rectifiedlinear units, often on the basis of hunches or heuristicarguments*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*A common justification is that $\max(0, z)$ doesn't  saturate in the limit of large $z$, unlike sigmoid neurons, and this  helps rectified linear units continue learning.  The argument is  fine, as far it goes, but it's hardly a detailed justification, more  of a just-so story.  Note that we discussed the problems with  saturation back in <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap2.html#saturation">chap2.html#saturation</a>"&gt;</span>Chapter 2<span class="html-tag">&lt;/a&gt;</span>.<span class="html-tag">&lt;/span&gt;</span>.They got good results classifying benchmark data sets, and thepractice has spread.  In an ideal world we'd have a theory telling uswhich activation function to pick for which application.  But atpresent we're a long way from such a world.  I should not be at allsurprised if further major improvements can be obtained by an evenbetter choice of activation function.  And I also expect that incoming decades a powerful theory of activation functions will bedeveloped.  Today, we still have to rely on poorly understood rules ofthumb and experience.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Expanding the training data:<span class="html-tag">&lt;/strong&gt;</span> Another way we may hope toimprove our results is by algorithmically expanding the training data.A simple way of expanding the training data is to displace eachtraining image by a single pixel, either up one pixel, down one pixel,left one pixel, or right one pixel.  We can do this by running theprogram <span class="html-tag">&lt;tt&gt;</span>expand_mnist.py<span class="html-tag">&lt;/tt&gt;</span> from the shell prompt*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*The code  for <span class="html-tag">&lt;tt&gt;</span>expand_mnist.py<span class="html-tag">&lt;/tt&gt;</span> is available  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/expand_mnist.py">https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/expand_mnist.py</a>"&gt;</span>here<span class="html-tag">&lt;/a&gt;</span>.<span class="html-tag">&lt;/span&gt;</span>:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span> </td></tr><tr><td class="line-number" value="210"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nv</span>"&gt;</span>$ <span class="html-tag">&lt;/span&gt;</span>python expand_mnist.py</td></tr><tr><td class="line-number" value="211"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="212"></td><td class="line-content"> <span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Running this program takes the $50,000$ MNIST training images, andprepares an expanded training set, with $250,000$ training images.  Wecan then use those training images to train our network.  We'll usethe same network as above, with rectified linear units.  In my initialexperiments I reduced the number of training epochs - this madesense, since we're training with $5$ times as much data.  But, infact, expanding the data turned out to considerably reduce the effectof overfitting.  And so, after some experimentation, I eventually wentback to training for $60$ epochs.  In any case, let's train:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>expanded_training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>_<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>_<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>network3<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>load_data_shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="213"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;../data/mnist_expanded.pkl.gz&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="214"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="215"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="216"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="217"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="218"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="219"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="220"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="221"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="222"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="223"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="224"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>10<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="225"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SGD<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>expanded_training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>60<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.03<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="226"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lmbda<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="227"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="228"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Using the expanded training data I obtained a $99.37$ percent trainingaccuracy.  So this almost trivial change gives a substantialimprovement in classification accuracy.  Indeed, as we<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques_for_regularization">chap3.html#other_techniques_for_regularization</a>"&gt;</span>discussed  earlier<span class="html-tag">&lt;/a&gt;</span> this idea of algorithmically expanding the data can betaken further.  Just to remind you of the flavour of some of theresults in that earlier discussion: in 2003 Simard, Steinkraus andPlatt*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://dx.doi.org/10.1109/ICDAR.2003.1227801">http://dx.doi.org/10.1109/ICDAR.2003.1227801</a>"&gt;</span>Best    Practices for Convolutional Neural Networks Applied to Visual    Document Analysis<span class="html-tag">&lt;/a&gt;</span>, by Patrice Simard, Dave Steinkraus, and John  Platt (2003).<span class="html-tag">&lt;/span&gt;</span> improved their MNIST performance to $99.6$ percentusing a neural network otherwise very similar to ours, using twoconvolutional-pooling layers, followed by a hidden fully-connectedlayer with $100$ neurons.  There were a few differences of detail intheir architecture - they didn't have the advantage of usingrectified linear units, for instance - but the key to their improvedperformance was expanding the training data.  They did this byrotating, translating, and skewing the MNIST training images.  Theyalso developed a process of "elastic distortion", a way of emulatingthe random oscillations hand muscles undergo when a person is writing.By combining all these processes they substantially increased theeffective size of their training data, and that's how they achieved$99.6$ percent accuracy.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h4&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">problem_437600</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#problem_437600">#problem_437600</a>"&gt;</span>Problem<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h4&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;li&gt;</span> The idea of convolutional layers is to behave in an invariant  way across images.  It may seem surprising, then, that our network  can learn more when all we've done is translate the input data.  Can  you explain why this is actually quite reasonable?<span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Inserting an extra fully-connected layer:<span class="html-tag">&lt;/strong&gt;</span> Can we do evenbetter?  One possibility is to use exactly the same procedure asabove, but to expand the size of the fully-connected layer.  I triedwith $300$ and $1,000$ neurons, obtaining results of $99.46$ and$99.43$ percent, respectively.  That's interesting, but not really aconvincing win over the earlier result ($99.37$ percent).<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>What about adding an extra fully-connected layer?  Let's try insertingan extra fully-connected layer, so that we have two $100$-hiddenneuron fully-connected layers:<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="229"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="230"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="231"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="232"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="233"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="234"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="235"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="236"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="237"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="238"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="239"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>100<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>10<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="240"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SGD<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>expanded_training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>60<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.03<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="241"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lmbda<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="242"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="243"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Doing this, I obtained a test accuracy of $99.43$ percent.  Again, theexpanded net isn't helping so much.  Running similar experiments withfully-connected layers containing $300$ and $1,000$ neurons yieldsresults of $99.48$ and $99.47$ percent.  That's encouraging, but stillfalls short of a really decisive win.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">final_conv</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>What's going on here?  Is it that the expanded or extrafully-connected layers really don't help with MNIST?  Or might it bethat our network has the capacity to do better, but we're going aboutlearning the wrong way?  For instance, maybe we could use strongerregularization techniques to reduce the tendency to overfit.  Onepossibility is the<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques_for_regularization">chap3.html#other_techniques_for_regularization</a>"&gt;</span>dropout<span class="html-tag">&lt;/a&gt;</span>technique introduced back in Chapter 3.  Recall that the basic idea ofdropout is to remove individual activations at random while trainingthe network.  This makes the model more robust to the loss ofindividual pieces of evidence, and thus less likely to rely onparticular idiosyncracies of the training data.  Let's try applyingdropout to the final fully-connected layers:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="244"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>28<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="245"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="246"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="247"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="248"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>12<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="249"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>20<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="250"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="251"></td><td class="line-content">                      <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="252"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="253"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>4<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1000<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="254"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="255"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1000<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1000<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="256"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1000<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>10<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)],<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="257"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="258"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;&amp;gt;&amp;gt;<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>SGD<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>expanded_training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>40<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.03<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="259"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="260"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="261"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Using this, we obtain an accuracy of $99.60$ percent, which is asubstantial improvement over our earlier results, especially our mainbenchmark, the network with $100$ hidden neurons, where we achieved$99.37$ percent.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>There are two changes worth noting.  <span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>First, I reduced the number of training epochs to $40$: dropoutreduced overfitting, and so we learned faster.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Second, the fully-connected hidden layers have $1,000$ neurons, notthe $100$ used earlier. Of course, dropout effectively omits many ofthe neurons while training, so some expansion is to be expected.  Infact, I tried experiments with both $300$ and $1,000$ hidden neurons,and obtained (very slightly) better validation performance with$1,000$ hidden neurons.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Using an ensemble of networks:<span class="html-tag">&lt;/strong&gt;</span> An easy way to improveperformance still further is to create several neural networks, andthen get them to vote to determine the best classification.  Suppose,for example, that we trained $5$ different neural networks using theprescription above, with each achieving accuracies near to $99.6$percent.  Even though the networks would all have similar accuracies,they might well make different errors, due to the different randominitializations.  It's plausible that taking a vote amongst our $5$networks might yield a classification better than any individualnetwork.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>This sounds too good to be true, but this kind of ensembling is acommon trick with both neural networks and other machine learningtechniques.  And it does in fact yield further improvements: we end upwith $99.67$ percent accuracy.  In other words, our ensemble ofnetworks classifies all but $33$ of the $10,000$ test imagescorrectly.  <span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The remaining errors in the test set are shown below.  The label inthe top right is the correct classification, according to the MNISTdata, while in the bottom right is the label output by our ensemble ofnets:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;center&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/ensemble_errors.png">images/ensemble_errors.png</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">580px</span>"&gt;</span><span class="html-tag">&lt;/center&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>It's worth looking through these in detail. The first two digits, a 6and a 5, are genuine errors by our ensemble.  However, they're alsounderstandable errors, the kind a human could plausibly make. That 6really does look a lot like a 0, and the 5 looks a lot like a 3.  Thethird image, supposedly an 8, actually looks to me more like a 9.  SoI'm siding with the network ensemble here: I think it's done a betterjob than whoever originally drew the digit.  On the other hand, thefourth image, the 6, really does seem to be classified badly by ournetworks.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>And so on.  In most cases our networks' choices seem at leastplausible, and in some cases they've done a better job classifyingthan the original person did writing the digit.  Overall, our networksoffer exceptional performance, especially when you consider that theycorrectly classified 9,967 images which aren't shown.  In thatcontext, the few clear errors here seem quite understandable.  Even acareful human makes the occasional mistake.  And so I expect that onlyan extremely careful and methodical human would do much better.  Ournetwork is getting near to human performance.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Why we only applied dropout to the fully-connected layers:<span class="html-tag">&lt;/strong&gt;</span> Ifyou look carefully at the code above, you'll notice that we applieddropout only to the fully-connected section of the network, not to theconvolutional layers.  In principle we could apply a similar procedureto the convolutional layers.  But, in fact, there's no need: theconvolutional layers have considerable inbuilt resistance tooverfitting.  The reason is that the shared weights mean thatconvolutional filters are forced to learn from across the entireimage.  This makes them less likely to pick up on local idiosyncraciesin the training data.  And so there is less need to apply otherregularizers, such as dropout.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Going further:<span class="html-tag">&lt;/strong&gt;</span> It's possible to improve performance on MNISTstill further. Rodrigo Benenson has compiled an<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://rodrigob.github.io/are_we_there_yet/build/classification_datasets_results.html">http://rodrigob.github.io/are_we_there_yet/build/classification_datasets_results.html</a>"&gt;</span>informative  summary page<span class="html-tag">&lt;/a&gt;</span>, showing progress over the years, with links topapers.  Many of these papers use deep convolutional networks alonglines similar to the networks we've been using.  If you dig throughthe papers you'll find many interesting techniques, and you may enjoyimplementing some of them.  If you do so it's wise to to startimplementation with a simple network that can be trained quickly,which will help you more rapidly understand what is going on.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>For the most part, I won't try to survey this recent work.  But Ican't resist making one exception.  It's a 2010 paper by Cirean,Meier, Gambardella, andSchmidhuber*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1003.0358">http://arxiv.org/abs/1003.0358</a>"&gt;</span>Deep, Big,    Simple Neural Nets Excel on Handwritten Digit Recognition<span class="html-tag">&lt;/a&gt;</span>, by Dan  Claudiu Cirean, Ueli Meier, Luca Maria Gambardella, and Jrgen  Schmidhuber (2010).<span class="html-tag">&lt;/span&gt;</span>.  What I like about this paper is how simple itis.  The network is a many-layer neural network, using onlyfully-connected layers (no convolutions).  Their most successfulnetwork had hidden layers containing $2,500$, $2,000$, $1,500$,$1,000$, and $500$ neurons, respectively.  They used ideas similar toSimard <span class="html-tag">&lt;em&gt;</span>et al<span class="html-tag">&lt;/em&gt;</span> to expand their training data.  But apart fromthat, they used few other tricks, including no convolutional layers:it was a plain, vanilla network, of the kind that, with enoughpatience, could have been trained in the 1980s (if the MNIST data sethad existed), given enough computing power(!)  They achieved aclassification accuracy of $99.65$ percent, more or less the same asours.  The key was to use a very large, very deep network, and to usea GPU to speed up training.  This let them train for many epochs.They also took advantage of their long training times to graduallydecrease the learning rate from $10^{-3}$ to $10^{-6}$.  It's a funexercise to try to match these results using an architecture liketheirs.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Why are we able to train?<span class="html-tag">&lt;/strong&gt;</span>  We saw in <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap5.html">chap5.html</a>"&gt;</span>the  last chapter<span class="html-tag">&lt;/a&gt;</span> that there are fundamental obstructions to training indeep, many-layer neural networks.  In particular, we saw that thegradient tends to be quite unstable: as we move from the output layerto earlier layers the gradient tends to either vanish (the vanishinggradient problem) or explode (the exploding gradient prolem).  Sincethe gradient is the signal we use to train, this causes problems.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>How have we avoided those results?  <span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Of course, the answer is that we haven't avoided these results.Instead, we've done a few things that help us proceed anyway.  Inparticular: (1) Using convolutional layers greatly reduces the numberof parameters in those layers, making the learning problem mucheasier; (2) Using more powerful regularization techniques (notablydropout and convolutional layers) to reduce overfitting, which isotherwise more of a problem in more complex networks; (3) Usingrectified linear units instead of sigmoid neurons, to speed uptraining - empirically, often by a factor of $3$-$5$; (4) Using GPUsand being willing to train for a long period of time.  In particular,in our final experiments we trained for $40$ epochs using a data set$5$ times larger than the raw MNIST training data.  Earlier in thebook we mostly trained for $30$ epochs using just the raw trainingdata.  Combining factors (3) and (4) it's as though we've trained afactor perhaps $30$ times longer than before.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Your response may be "Is that it? Is that all we had to do to traindeep networks?  What's all the fuss about?"<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Of course, we've used other ideas, too: making use of sufficientlylarge data sets (to help avoid overfitting); using the right costfunction (to<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#the_cross\-entropy_cost_function">chap3.html#the_cross\-entropy_cost_function</a>"&gt;</span>avoid a  learning slowdown<span class="html-tag">&lt;/a&gt;</span>); using<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network's_hyper-parameters">chap3.html#how_to_choose_a_neural_network's_hyper-parameters</a>"&gt;</span>good  weight initializations<span class="html-tag">&lt;/a&gt;</span> (also to avoid a learning slowdown, due toneuron saturation);<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques_for_regularization">chap3.html#other_techniques_for_regularization</a>"&gt;</span>algorithmically  expanding the training data<span class="html-tag">&lt;/a&gt;</span>.  We discussed these and other ideas inearlier chapters, and have for the most part been able to reuse theseideas with little comment in this chapter.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>With that said, this really is a rather simple set of ideas.  Simple,but powerful, when used in concert.  Getting started with deeplearning has turned out to be pretty easy!<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>How deep are these networks, anyway?<span class="html-tag">&lt;/strong&gt;</span> Counting theconvolutional-pooling layers as single layers, our final architecturehas $4$ hidden layers.  Does such a network really deserve to becalled a <span class="html-tag">&lt;em&gt;</span>deep<span class="html-tag">&lt;/em&gt;</span> network?  Of course, $4$ hidden layers is manymore than in the shallow networks we studied earlier.  Most of thosenetworks only had a single hidden layer, or occasionally $2$ hiddenlayers.  On the other hand, as of 2015 state-of-the-art deep networkssometimes have dozens of hidden layers.  I've occasionally heardpeople adopt a deeper-than-thou attitude, holding that if you're notkeeping-up-with-the-Joneses in terms of number of hidden layers, thenyou're not really doing deep learning.  I'm not sympathetic to thisattitude, in part because it makes the definition of deep learninginto something which depends upon the result-of-the-moment. The realbreakthrough in deep learning was to realize that it's practical to gobeyond the shallow $1$- and $2$-hidden layer networks that dominatedwork until the mid-2000s.  That really was a significant breakthrough,opening up the exploration of much more expressive models.  But beyondthat, the number of layers is not of primary fundamental interest.Rather, the use of deeper networks is a tool to use to help achieveother goals - like better classification accuracies.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>A word on procedure:<span class="html-tag">&lt;/strong&gt;</span> In this section, we've smoothly movedfrom single hidden-layer shallow networks to many-layer convolutionalnetworks.  It's all seemed so easy!  We make a change and, for themost part, we get an improvement.  If you start experimenting, I canguarantee things won't always be so smooth.  The reason is that I'vepresented a cleaned-up narrative, omitting many experiments -including many failed experiments.  This cleaned-up narrative willhopefully help you get clear on the basic ideas.  But it also runs therisk of conveying an incomplete impression.  Getting a good, workingnetwork can involve a lot of trial and error, and occasionalfrustration.  In practice, you should expect to engage in quite a bitof experimentation.  To speed that process up you may find it helpfulto revisit Chapter 3's discussion of<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#how_to_choose_a_neural_network's_hyper-parameters">chap3.html#how_to_choose_a_neural_network's_hyper-parameters</a>"&gt;</span>how  to choose a neural network's hyper-parameters<span class="html-tag">&lt;/a&gt;</span>, and perhaps also tolook at some of the further reading suggested in that section.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h3&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">the_code_for_our_convolutional_networks</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#the_code_for_our_convolutional_networks">#the_code_for_our_convolutional_networks</a>"&gt;</span>The code for our convolutional networks<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h3&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Alright, let's take a look at the code for our program,<span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span>.  Structurally, it's similar to <span class="html-tag">&lt;tt&gt;</span>network2.py<span class="html-tag">&lt;/tt&gt;</span>,the program we developed in <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html">chap3.html</a>"&gt;</span>Chapter 3<span class="html-tag">&lt;/a&gt;</span>, although thedetails differ, due to the use of Theano.  We'll start by looking atthe <span class="html-tag">&lt;tt&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/tt&gt;</span> class, which is similar to the layersstudied earlier in the book.  Here's the code (discussion below):<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>class<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nc</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>():<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="262"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="263"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>__init__<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sigmoid<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="264"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="265"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="266"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="267"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="268"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># Initialize weights and biases<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="269"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="270"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>asarray<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="271"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>random<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>normal<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="272"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>loc<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>scale<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sqrt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>1.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="273"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="274"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>name<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;w&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="275"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="276"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>asarray<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>random<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>normal<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>loc<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>scale<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>1.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,)),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="277"></td><td class="line-content">                       <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="278"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>name<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;b&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="279"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="280"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="281"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>set_inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="282"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>reshape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>((<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="283"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="284"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dot<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="285"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>argmax<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>axis<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="286"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dropout_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="287"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>reshape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>((<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="288"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="289"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dot<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="290"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="291"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="292"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Return the accuracy for the mini-batch.&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="293"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mean<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>eq<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="294"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="295"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Much of the <span class="html-tag">&lt;tt&gt;</span>__init__<span class="html-tag">&lt;/tt&gt;</span> method is self-explanatory, but a fewremarks may help clarify the code.  As per usual, we randomlyinitialize the weights and biases as normal random variables withsuitable standard deviations.  The lines doing this look a littleforbidding.  However, most of the complication is just loading theweights and biases into what Theano calls shared variables.  Thisensures that these variables can be processed on the GPU, if one isavailable.  We won't get too much into the details of this.  If you'reinterested, you can dig into the<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://deeplearning.net/software/theano/index.html">http://deeplearning.net/software/theano/index.html</a>"&gt;</span>Theano  documentation<span class="html-tag">&lt;/a&gt;</span>.  Note also that this weight and bias initializationare designed for the sigmoid activation function (as<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization">chap3.html#weight_initialization</a>"&gt;</span>discussed earlier<span class="html-tag">&lt;/a&gt;</span>).Ideally, we'd initialize the weights and biases somewhat differentlyfor activation functions such as the tanh and rectified linearfunction.  This is discussed further in problems below.  The<span class="html-tag">&lt;tt&gt;</span>__init__<span class="html-tag">&lt;/tt&gt;</span> method finishes with<span class="html-tag">&lt;tt&gt;</span>self.params = [self.W, self.b]<span class="html-tag">&lt;/tt&gt;</span>.  This is a handy way to bundleup all the learnable parameters associated to the layer.  Later on,the <span class="html-tag">&lt;tt&gt;</span>Network.SGD<span class="html-tag">&lt;/tt&gt;</span> method will use <span class="html-tag">&lt;tt&gt;</span>params<span class="html-tag">&lt;/tt&gt;</span> attributes tofigure out what variables in a <span class="html-tag">&lt;tt&gt;</span>Network<span class="html-tag">&lt;/tt&gt;</span> instance can learn.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The <span class="html-tag">&lt;tt&gt;</span>set_inpt<span class="html-tag">&lt;/tt&gt;</span> method is used to set the input to the layer, andto compute the corresponding output.  I use the name <span class="html-tag">&lt;tt&gt;</span>inpt<span class="html-tag">&lt;/tt&gt;</span>rather than <span class="html-tag">&lt;tt&gt;</span>input<span class="html-tag">&lt;/tt&gt;</span> because <span class="html-tag">&lt;tt&gt;</span>input<span class="html-tag">&lt;/tt&gt;</span> is a built-in functionin Python, and messing with built-ins tends to cause unpredictablebehavior and difficult-to-diagnose bugs.  Note that we actually setthe input in two separate ways: as <span class="html-tag">&lt;tt&gt;</span>self.inpt<span class="html-tag">&lt;/tt&gt;</span> and<span class="html-tag">&lt;tt&gt;</span>self.inpt_dropout<span class="html-tag">&lt;/tt&gt;</span>.  This is done because during training we maywant to use dropout.  If that's the case then we want to remove afraction <span class="html-tag">&lt;tt&gt;</span>self.p_dropout<span class="html-tag">&lt;/tt&gt;</span> of the neurons.  That's what thefunction <span class="html-tag">&lt;tt&gt;</span>dropout_layer<span class="html-tag">&lt;/tt&gt;</span> in the second-last line of the<span class="html-tag">&lt;tt&gt;</span>set_inpt<span class="html-tag">&lt;/tt&gt;</span> method is doing.  So <span class="html-tag">&lt;tt&gt;</span>self.inpt_dropout<span class="html-tag">&lt;/tt&gt;</span> and<span class="html-tag">&lt;tt&gt;</span>self.output_dropout<span class="html-tag">&lt;/tt&gt;</span> are used during training, while<span class="html-tag">&lt;tt&gt;</span>self.inpt<span class="html-tag">&lt;/tt&gt;</span> and <span class="html-tag">&lt;tt&gt;</span>self.output<span class="html-tag">&lt;/tt&gt;</span> are used for all otherpurposes, e.g., evaluating accuracy on the validation and test data.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The <span class="html-tag">&lt;tt&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/tt&gt;</span> and <span class="html-tag">&lt;tt&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/tt&gt;</span> class definitions aresimilar to <span class="html-tag">&lt;tt&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/tt&gt;</span>.  Indeed, they're so close thatI won't excerpt the code here.  If you're interested you can look atthe full listing for <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span>, later in this section.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>However, a couple of minor differences of detail are worth mentioning.Most obviously, in both <span class="html-tag">&lt;tt&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/tt&gt;</span> and <span class="html-tag">&lt;tt&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/tt&gt;</span>we compute the output activations in the way appropriate to that layertype.  Fortunately, Theano makes that easy, providing built-inoperations to compute convolutions, max-pooling, and the softmaxfunction.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Less obviously, when we <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#softmax">chap3.html#softmax</a>"&gt;</span>introduced the  softmax layer<span class="html-tag">&lt;/a&gt;</span>, we never discussed how to initialize the weights andbiases.  Elsewhere we've argued that for sigmoid layers we shouldinitialize the weights using suitably parameterized normal randomvariables.  But that heuristic argument was specific to sigmoidneurons (and, with some amendment, to tanh neurons).  However, there'sno particular reason the argument should apply to softmax layers.  Sothere's no <span class="html-tag">&lt;em&gt;</span>a priori<span class="html-tag">&lt;/em&gt;</span> reason to apply that initialization again.Rather than do that, I shall initialize all the weights and biases tobe $0$.  This is a rather <span class="html-tag">&lt;em&gt;</span>ad hoc<span class="html-tag">&lt;/em&gt;</span> procedure, but works wellenough in practice.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Okay, we've looked at all the layer classes.  What about the<span class="html-tag">&lt;tt&gt;</span>Network<span class="html-tag">&lt;/tt&gt;</span> class?  Let's start by looking at the <span class="html-tag">&lt;tt&gt;</span>__init__<span class="html-tag">&lt;/tt&gt;</span>method:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>class<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nc</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>():<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="296"></td><td class="line-content">    </td></tr><tr><td class="line-number" value="297"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>__init__<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="298"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>&amp;quot;&amp;quot;&amp;quot;Takes a list of `layers`, describing the network architecture, and<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="299"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        a value for the `mini_batch_size` to be used during training<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="300"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        by stochastic gradient descent.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="301"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="302"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        &amp;quot;&amp;quot;&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="303"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="304"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="305"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="306"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>matrix<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;x&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span>  </td></tr><tr><td class="line-number" value="307"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ivector<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;y&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="308"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>init_layer<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="309"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>init_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>set_inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="310"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>len<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="311"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>prev_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span>  <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="312"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>set_inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="313"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>prev_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>prev_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="314"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="315"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="316"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="317"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Most of this is self-explanatory, or nearly so.  The line<span class="html-tag">&lt;tt&gt;</span>self.params = [param for layer in ...]<span class="html-tag">&lt;/tt&gt;</span> bundles up theparameters for each layer into a single list.  As anticipated above,the <span class="html-tag">&lt;tt&gt;</span>Network.SGD<span class="html-tag">&lt;/tt&gt;</span> method will use <span class="html-tag">&lt;tt&gt;</span>self.params<span class="html-tag">&lt;/tt&gt;</span> to figureout what variables in the <span class="html-tag">&lt;tt&gt;</span>Network<span class="html-tag">&lt;/tt&gt;</span> can learn.  The lines<span class="html-tag">&lt;tt&gt;</span>self.x = T.matrix("x")<span class="html-tag">&lt;/tt&gt;</span> and <span class="html-tag">&lt;tt&gt;</span>self.y = T.ivector("y")<span class="html-tag">&lt;/tt&gt;</span>define Theano symbolic variables named <span class="html-tag">&lt;tt&gt;</span>x<span class="html-tag">&lt;/tt&gt;</span> and <span class="html-tag">&lt;tt&gt;</span>y<span class="html-tag">&lt;/tt&gt;</span>.  Thesewill be used to represent the input and desired output from thenetwork.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Now, this isn't a Theano tutorial, and so we won't get too deeply intowhat it means that these are symbolic variables*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*The  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://deeplearning.net/software/theano/index.html">http://deeplearning.net/software/theano/index.html</a>"&gt;</span>Theano    documentation<span class="html-tag">&lt;/a&gt;</span> provides a good introduction to Theano.  And if you  get stuck, you may find it helpful to look at one of the other  tutorials available online.  For instance,  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://nbviewer.ipython.org/github/craffel/theano-tutorial/blob/master/Theano%20Tutorial.ipynb">http://nbviewer.ipython.org/github/craffel/theano-tutorial/blob/master/Theano%20Tutorial.ipynb</a>"&gt;</span>this    tutorial<span class="html-tag">&lt;/a&gt;</span> covers many basics.<span class="html-tag">&lt;/span&gt;</span>.  But the rough idea is that theserepresent mathematical variables, <span class="html-tag">&lt;em&gt;</span>not<span class="html-tag">&lt;/em&gt;</span> explicit values.  We cando all the usual things one would do with such variables: add,subtract, and multiply them, apply functions, and so on.  Indeed,Theano provides many ways of manipulating such symbolic variables,doing things like convolutions, max-pooling, and so on.  But the bigwin is the ability to do fast symbolic differentiation, using a verygeneral form of the backpropagation algorithm.  This is extremelyuseful for applying stochastic gradient descent to a wide variety ofnetwork architectures.  In particular, the next few lines of codedefine symbolic outputs from the network.  We start by setting theinput to the initial layer, with the line<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span>        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>init_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>set_inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="318"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="319"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Note that the inputs are set one mini-batch at a time, which is whythe mini-batch size is there.  Note also that we pass the input<span class="html-tag">&lt;tt&gt;</span>self.x<span class="html-tag">&lt;/tt&gt;</span> in twice: this is because we may use the network in twodifferent ways (with or without dropout).  The <span class="html-tag">&lt;tt&gt;</span>for<span class="html-tag">&lt;/tt&gt;</span> loop thenpropagates the symbolic variable <span class="html-tag">&lt;tt&gt;</span>self.x<span class="html-tag">&lt;/tt&gt;</span> forward through thelayers of the <span class="html-tag">&lt;tt&gt;</span>Network<span class="html-tag">&lt;/tt&gt;</span>. This allows us to define the final<span class="html-tag">&lt;tt&gt;</span>output<span class="html-tag">&lt;/tt&gt;</span> and <span class="html-tag">&lt;tt&gt;</span>output_dropout<span class="html-tag">&lt;/tt&gt;</span> attributes, which symbolicallyrepresent the output from the <span class="html-tag">&lt;tt&gt;</span>Network<span class="html-tag">&lt;/tt&gt;</span>.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Now that we've understood how a <span class="html-tag">&lt;tt&gt;</span>Network<span class="html-tag">&lt;/tt&gt;</span> is initialized, let'slook at how it is trained, using the <span class="html-tag">&lt;tt&gt;</span>SGD<span class="html-tag">&lt;/tt&gt;</span> method.  The codelooks lengthy, but its structure is actually rather simple.Explanatory comments after the code.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span>    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>SGD<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epochs<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>eta<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="320"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lmbda<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="321"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>&amp;quot;&amp;quot;&amp;quot;Train the network using mini-batch stochastic gradient descent.&amp;quot;&amp;quot;&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="322"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_y<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="323"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_y<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="324"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_y<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="325"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="326"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># compute number of minibatches for training, validation and testing<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="327"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="328"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_validation_batches<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="329"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_test_batches<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="330"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="331"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># define the (regularized) cost function, symbolic gradients, and updates<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="332"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>l2_norm_squared<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>sum<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>**<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sum<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>()<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>])<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="333"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span>\</td></tr><tr><td class="line-number" value="334"></td><td class="line-content">               <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lmbda<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>l2_norm_squared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="335"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grads<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grad<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="336"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>updates<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>eta<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grad<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="337"></td><td class="line-content">                   <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grad<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>zip<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grads<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="338"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="339"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># define functions to train a mini-batch, and to compute the<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="340"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># accuracy in validation and test mini-batches.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="341"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lscalar<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>()<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># mini-batch index<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="342"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>train_mb<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>function<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="343"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>updates<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>updates<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="344"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>givens<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>{<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="345"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="346"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="347"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="348"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="349"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>})<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="350"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validate_mb_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>function<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="351"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="352"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>givens<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>{<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="353"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="354"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="355"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="356"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="357"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>})<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="358"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_mb_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>function<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="359"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="360"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>givens<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>{<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="361"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="362"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="363"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="364"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="365"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>})<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="366"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_mb_predictions<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>function<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="367"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="368"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>givens<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>{<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="369"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="370"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="371"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>})<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="372"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># Do the actual training<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="373"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_validation_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="374"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epoch<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epochs<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="375"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>minibatch_index<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="376"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epoch<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>minibatch_index<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="377"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>if<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="378"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Training mini-batch number {0}&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>format<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="379"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost_ij<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>train_mb<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>minibatch_index<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="380"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>if<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="381"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mean<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="382"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validate_mb_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_validation_batches<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)])<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="383"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Epoch {0}: validation accuracy {1:.2<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="384"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epoch<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="385"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>if<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_validation_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="386"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;This is the best validation accuracy to date.&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="387"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_validation_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_accuracy<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="388"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_iteration<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="389"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>if<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="390"></td><td class="line-content">                            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mean<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="391"></td><td class="line-content">                                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_mb_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_test_batches<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)])<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="392"></td><td class="line-content">                            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;The corresponding test accuracy is {0:.2<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="393"></td><td class="line-content">                                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="394"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Finished training network.&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="395"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Best validation accuracy of {0:.2<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="396"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_validation_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_iteration<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="397"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Corresponding test accuracy of {0:.2<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="398"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="399"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The first few lines are straightforward, separating the datasets into$x$ and $y$ components, and computing the number of mini-batches usedin each dataset.  The next few lines are more interesting, and showsome of what makes Theano fun to work with.  Let's explicitly excerptthe lines here:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span>        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># define the (regularized) cost function, symbolic gradients, and updates<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="400"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>l2_norm_squared<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>sum<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>**<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sum<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>()<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>])<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="401"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span>\</td></tr><tr><td class="line-number" value="402"></td><td class="line-content">               <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lmbda<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>l2_norm_squared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="403"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grads<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grad<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="404"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>updates<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>eta<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grad<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="405"></td><td class="line-content">                   <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grad<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>zip<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grads<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="406"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="407"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In these lines we symbolically set up the regularized log-likelihoodcost function, compute the corresponding derivatives in the gradientfunction, as well as the corresponding parameter updates.  Theano letsus achieve all of this in just these few lines.  The only thing hiddenis that computing the <span class="html-tag">&lt;tt&gt;</span>cost<span class="html-tag">&lt;/tt&gt;</span> involves a call to the <span class="html-tag">&lt;tt&gt;</span>cost<span class="html-tag">&lt;/tt&gt;</span>method for the output layer; that code is elsewhere in<span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span>.  But that code is short and simple, anyway.  Withall these things defined, the stage is set to define the<span class="html-tag">&lt;tt&gt;</span>train_mini_batch<span class="html-tag">&lt;/tt&gt;</span> function, a Theano symbolic function whichuses the <span class="html-tag">&lt;tt&gt;</span>updates<span class="html-tag">&lt;/tt&gt;</span> to update the <span class="html-tag">&lt;tt&gt;</span>Network<span class="html-tag">&lt;/tt&gt;</span> parameters, givena mini-batch index.  Similarly, <span class="html-tag">&lt;tt&gt;</span>validate_mb_accuracy<span class="html-tag">&lt;/tt&gt;</span> and<span class="html-tag">&lt;tt&gt;</span>test_mb_accuracy<span class="html-tag">&lt;/tt&gt;</span> compute the accuracy of the <span class="html-tag">&lt;tt&gt;</span>Network<span class="html-tag">&lt;/tt&gt;</span> onany given mini-batch of validation or test data.  By averaging overthese functions, we will be able to compute accuracies on the entirevalidation and test data sets.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The remainder of the <span class="html-tag">&lt;tt&gt;</span>SGD<span class="html-tag">&lt;/tt&gt;</span> method is self-explanatory - wesimply iterate over the epochs, repeatedly training the network onmini-batches of training data, and computing the validation and testaccuracies.  <span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Okay, we've now understood the most important pieces of code in<span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span>.  Let's take a brief look at the entire program.You don't need to read through this in detail, but you may enjoyglancing over it, and perhaps diving down into any pieces that strikeyour fancy.  The best way to really understand it is, of course, bymodifying it, adding extra features, or refactoring anything you thinkcould be done more elegantly.  After the code, there are some problemswhich contain a few starter suggestions for things to do.  Here's thecode*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*Using Theano on a GPU can be a little tricky.  In  particular, it's easy to make the mistake of pulling data off the  GPU, which can slow things down a lot.  I've tried to avoid this,  but wouldn't be surprised if this code can be sped up further.  I'd  appreciate hearing any tips for further improvement  (mn@michaelnielsen.org).<span class="html-tag">&lt;/span&gt;</span>:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">highlight</span>"&gt;</span><span class="html-tag">&lt;pre&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>&amp;quot;&amp;quot;&amp;quot;network3.py<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="408"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>~~~~~~~~~~~~~~<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="409"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="410"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>A Theano-based program for training and running simple neural<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="411"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>networks.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="412"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="413"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>Supports several layer types (fully connected, convolutional, max<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="414"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>pooling, softmax), and activation functions (sigmoid, tanh, and<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="415"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>rectified linear units, with more easily added).<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="416"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="417"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>When run on a CPU, this program is much faster than network.py and<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="418"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>network2.py.  However, unlike network.py and network2.py it can also<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="419"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>be run on a GPU, which makes it faster still.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="420"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="421"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>Because the code is based on Theano, the code is different in many<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="422"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>ways from network.py and network2.py.  However, where possible I have<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="423"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>tried to maintain consistency with the earlier programs.  In<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="424"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>particular, the API is similar to network2.py.  Note that I have<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="425"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>focused on making the code simple, easily readable, and easily<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="426"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>modifiable.  It is not optimized, and omits many desirable features.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="427"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="428"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>This program incorporates ideas from the Theano documentation on<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="429"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>convolutional neural nets (notably,<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="430"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>http://deeplearning.net/tutorial/lenet.html ), from Misha Denil&amp;#39;s<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="431"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>implementation of dropout (https://github.com/mdenil/dropout ), and<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="432"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>from Chris Olah (http://colah.github.io ).<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="433"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="434"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>&amp;quot;&amp;quot;&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="435"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="436"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span>#### Libraries<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="437"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># Standard library<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="438"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>cPickle<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="439"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>gzip<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="440"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="441"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># Third-party libraries<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="442"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>numpy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>as<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="443"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="444"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>theano.tensor<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>as<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="445"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>from<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>theano.tensor.nnet<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>conv<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="446"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>from<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>theano.tensor.nnet<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>softmax<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="447"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>from<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>theano.tensor<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared_randomstreams<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="448"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>from<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>theano.tensor.signal<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>downsample<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="449"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="450"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># Activation functions for neurons<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="451"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>linear<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>z<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>z<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="452"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>ReLU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>z<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>maximum<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>z<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="453"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>from<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>theano.tensor.nnet<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sigmoid<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="454"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>from<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nn</span>"&gt;</span>theano.tensor<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">kn</span>"&gt;</span>import<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>tanh<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="455"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="456"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="457"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span>#### Constants<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="458"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>GPU<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="459"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>if<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>GPU<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="460"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Trying to run under a GPU.  If this is not desired, then modify &amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span>\</td></tr><tr><td class="line-number" value="461"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;network3.py<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">se</span>"&gt;</span>\n<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>to set the GPU flag to False.&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="462"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>try<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>device<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;gpu&amp;#39;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="463"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>except<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>pass<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># it&amp;#39;s already set<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="464"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;float32&amp;#39;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="465"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>else<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="466"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Running with a CPU.  If this is not desired, then the modify &amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span>\</td></tr><tr><td class="line-number" value="467"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;network3.py to set<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">se</span>"&gt;</span>\n<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>the GPU flag to True.&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="468"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="469"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span>#### Load the MNIST data<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="470"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>load_data_shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filename<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;../data/mnist.pkl.gz&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="471"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>f<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>gzip<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>open<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filename<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;rb&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="472"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cPickle<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>load<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>f<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="473"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>f<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>close<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>()<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="474"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="475"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>&amp;quot;&amp;quot;&amp;quot;Place the data into shared variables.  This allows Theano to copy<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="476"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        the data to the GPU, if one is available.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="477"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="478"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        &amp;quot;&amp;quot;&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="479"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared_x<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="480"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>asarray<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="481"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared_y<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="482"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>asarray<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="483"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cast<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared_y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;int32&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="484"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="485"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="486"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span>#### Main class used to construct and train networks<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="487"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>class<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nc</span>"&gt;</span>Network<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>():<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="488"></td><td class="line-content">    </td></tr><tr><td class="line-number" value="489"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>__init__<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="490"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>&amp;quot;&amp;quot;&amp;quot;Takes a list of `layers`, describing the network architecture, and<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="491"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        a value for the `mini_batch_size` to be used during training<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="492"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        by stochastic gradient descent.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="493"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="494"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        &amp;quot;&amp;quot;&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="495"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="496"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="497"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="498"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>matrix<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;x&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span>  </td></tr><tr><td class="line-number" value="499"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ivector<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;y&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="500"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>init_layer<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="501"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>init_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>set_inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="502"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>len<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="503"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>prev_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span>  <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="504"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>set_inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="505"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>prev_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>prev_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="506"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="507"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="508"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="509"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>SGD<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epochs<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>eta<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="510"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lmbda<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="511"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>&amp;quot;&amp;quot;&amp;quot;Train the network using mini-batch stochastic gradient descent.&amp;quot;&amp;quot;&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="512"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_y<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="513"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_y<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="514"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_y<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="515"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="516"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># compute number of minibatches for training, validation and testing<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="517"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="518"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_validation_batches<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="519"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_test_batches<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="520"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="521"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># define the (regularized) cost function, symbolic gradients, and updates<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="522"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>l2_norm_squared<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>sum<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>([(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>**<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sum<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>()<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>])<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="523"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span>\</td></tr><tr><td class="line-number" value="524"></td><td class="line-content">               <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.5<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lmbda<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>l2_norm_squared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="525"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grads<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grad<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="526"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>updates<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>eta<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grad<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="527"></td><td class="line-content">                   <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>param<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grad<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>zip<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>grads<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="528"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="529"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># define functions to train a mini-batch, and to compute the<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="530"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># accuracy in validation and test mini-batches.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="531"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>lscalar<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>()<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># mini-batch index<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="532"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>train_mb<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>function<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="533"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>updates<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>updates<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="534"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>givens<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>{<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="535"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="536"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="537"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="538"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>training_y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="539"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>})<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="540"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validate_mb_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>function<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="541"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="542"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>givens<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>{<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="543"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="544"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="545"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="546"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="547"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>})<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="548"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_mb_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>function<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="549"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="550"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>givens<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>{<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="551"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="552"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="553"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="554"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="555"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>})<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="556"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_mb_predictions<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>function<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="557"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layers<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="558"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>givens<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>{<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="559"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="560"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_x<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>i<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="561"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>})<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="562"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># Do the actual training<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="563"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_validation_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="564"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epoch<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epochs<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="565"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>minibatch_index<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="566"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epoch<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>minibatch_index<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="567"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>if<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>%<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1000<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>==<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="568"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Training mini-batch number {0}&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>format<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="569"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cost_ij<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>train_mb<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>minibatch_index<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="570"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>if<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>%<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_training_batches<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>==<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="571"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mean<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="572"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validate_mb_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_validation_batches<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)])<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="573"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Epoch {0}: validation accuracy {1:.2%}&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>format<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="574"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>epoch<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="575"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>if<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>&amp;gt;=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_validation_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="576"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;This is the best validation accuracy to date.&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="577"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_validation_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>validation_accuracy<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="578"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_iteration<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>iteration<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="579"></td><td class="line-content">                        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>if<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="580"></td><td class="line-content">                            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_accuracy<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mean<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="581"></td><td class="line-content">                                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_mb_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>for<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>j<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">ow</span>"&gt;</span>in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>xrange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>num_test_batches<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)])<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="582"></td><td class="line-content">                            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;The corresponding test accuracy is {0:.2%}&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>format<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="583"></td><td class="line-content">                                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="584"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Finished training network.&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="585"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Best validation accuracy of {0:.2%} obtained at iteration {1}&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>format<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="586"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_validation_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>best_iteration<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="587"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>print<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Corresponding test accuracy of {0:.2%}&amp;quot;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>format<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>test_accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="588"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="589"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span>#### Define layer types<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="590"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="591"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>class<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nc</span>"&gt;</span>ConvPoolLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>():<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="592"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>&amp;quot;&amp;quot;&amp;quot;Used to create a combination of a convolutional and a max-pooling<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="593"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>    layer.  A more sophisticated implementation would separate the<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="594"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>    two, but for our purposes we&amp;#39;ll always use them together, and it<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="595"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>    simplifies the code, so it makes sense to combine them.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="596"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="597"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>    &amp;quot;&amp;quot;&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="598"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="599"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>__init__<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> </td></tr><tr><td class="line-number" value="600"></td><td class="line-content">                 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sigmoid<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="601"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>&amp;quot;&amp;quot;&amp;quot;`filter_shape` is a tuple of length 4, whose entries are the number<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="602"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        of filters, the number of input feature maps, the filter height, and the <span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="603"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        filter width.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="604"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="605"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        `image_shape` is a tuple of length 4, whose entries are the<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="606"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        mini-batch size, the number of input feature maps, the image<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="607"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        height, and the image width.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="608"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="609"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        `poolsize` is a tuple of length 2, whose entries are the y and<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="610"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        x pooling sizes.<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="611"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="612"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">sd</span>"&gt;</span>        &amp;quot;&amp;quot;&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="613"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="614"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="615"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="616"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="617"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># initialize weights and biases<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="618"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>prod<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>2<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>:])<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>prod<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="619"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="620"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>asarray<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="621"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>random<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>normal<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>loc<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>scale<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sqrt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>1.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="622"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="623"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="624"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="625"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>asarray<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="626"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>random<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>normal<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>loc<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>scale<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>1.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>],)),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="627"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="628"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="629"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="630"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="631"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>set_inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="632"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>reshape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="633"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>conv_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>conv<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>conv2d<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="634"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>input<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filters<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>filter_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="635"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>image_shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="636"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>pooled_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>downsample<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>max_pool_2d<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="637"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nb</span>"&gt;</span>input<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>conv_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ds<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>poolsize<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>ignore_border<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="638"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="639"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>pooled_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dimshuffle<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;x&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;x&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;x&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="640"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># no dropout in the convolutional layers<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="641"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="642"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>class<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nc</span>"&gt;</span>FullyConnectedLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>():<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="643"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="644"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>__init__<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sigmoid<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="645"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="646"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="647"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="648"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="649"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># Initialize weights and biases<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="650"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="651"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>asarray<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="652"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>random<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>normal<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="653"></td><td class="line-content">                    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>loc<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>scale<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>sqrt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>1.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>/<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="654"></td><td class="line-content">                <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="655"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>name<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;w&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="656"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="657"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>asarray<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>random<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>normal<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>loc<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>scale<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>1.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,)),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="658"></td><td class="line-content">                       <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="659"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>name<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;b&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="660"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="661"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="662"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>set_inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="663"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>reshape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>((<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="664"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="665"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dot<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="666"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>argmax<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>axis<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="667"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dropout_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="668"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>reshape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>((<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="669"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>activation_fn<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="670"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dot<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="671"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="672"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="673"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Return the accuracy for the mini-batch.&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="674"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mean<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>eq<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="675"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="676"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>class<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nc</span>"&gt;</span>SoftmaxLayer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>():<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="677"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="678"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>__init__<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mf</span>"&gt;</span>0.0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="679"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="680"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="681"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="682"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span># Initialize weights and biases<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="683"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="684"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>zeros<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>((<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="685"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>name<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;w&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="686"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="687"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>zeros<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>((<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dtype<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>),<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="688"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>name<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;#39;b&amp;#39;<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="689"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>params<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="690"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="691"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>set_inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="692"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>reshape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>((<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="693"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>softmax<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>((<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dot<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="694"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y_out<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>argmax<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>axis<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="695"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dropout_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="696"></td><td class="line-content">            <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>reshape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>((<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mini_batch_size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n_in<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="697"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>softmax<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>dot<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>inpt_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>w<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>+<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>b<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="698"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="699"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>cost<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="700"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Return the log-likelihood cost.&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="701"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mean<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>log<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>output_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>arange<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]),<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>net<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>])<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="702"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="703"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>accuracy<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="704"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Return the accuracy for the mini-batch.&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="705"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mean<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>eq<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>self<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>y_out<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="706"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="707"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="708"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">c</span>"&gt;</span>#### Miscellanea<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="709"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="710"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">s</span>"&gt;</span>&amp;quot;Return the size of the dataset `data`.&amp;quot;<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="711"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>data<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>get_value<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>borrow<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">bp</span>"&gt;</span>True<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>[<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>]<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="712"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="713"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>def<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">nf</span>"&gt;</span>dropout_layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>):<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="714"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>srng<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shared_randomstreams<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>RandomStreams<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="715"></td><td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>np<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>random<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>RandomState<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>0<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>randint<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>999999<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>))<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="716"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mask<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>srng<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>binomial<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>n<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">mi</span>"&gt;</span>1<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>-<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>p_dropout<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>size<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>=<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>shape<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="717"></td><td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">k</span>"&gt;</span>return<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>layer<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>*<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>T<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>cast<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>(<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>mask<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>,<span class="html-tag">&lt;/span&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>theano<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>config<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">o</span>"&gt;</span>.<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">n</span>"&gt;</span>floatX<span class="html-tag">&lt;/span&gt;</span><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">p</span>"&gt;</span>)<span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="718"></td><td class="line-content"><span class="html-tag">&lt;/pre&gt;</span><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="719"></td><td class="line-content"><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h4&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">problems_210372</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#problems_210372">#problems_210372</a>"&gt;</span>Problems<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h4&gt;</span><span class="html-tag">&lt;ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;li&gt;</span> At present, the <span class="html-tag">&lt;tt&gt;</span>SGD<span class="html-tag">&lt;/tt&gt;</span> method requires the user to manually  choose the number of epochs to train for.  Earlier in the book we  discussed an automated way of selecting the number of epochs to  train for, known as <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#early_stopping">chap3.html#early_stopping</a>"&gt;</span>early    stopping<span class="html-tag">&lt;/a&gt;</span>.  Modify <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> to implement early stopping.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;li&gt;</span> Add a <span class="html-tag">&lt;tt&gt;</span>Network<span class="html-tag">&lt;/tt&gt;</span> method to return the accuracy on an  arbitrary data set.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;li&gt;</span> Modify the <span class="html-tag">&lt;tt&gt;</span>SGD<span class="html-tag">&lt;/tt&gt;</span> method to allow the learning rate $\eta$  to be a function of the epoch number.  <span class="html-tag">&lt;em&gt;</span>Hint: After working on    this problem for a while, you may find it useful to see the    discussion at    <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://groups.google.com/forum/#!topic/theano-users/NQ9NYLvleGc">https://groups.google.com/forum/#!topic/theano-users/NQ9NYLvleGc</a>"&gt;</span>this      link<span class="html-tag">&lt;/a&gt;</span>.<span class="html-tag">&lt;/em&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;li&gt;</span> Earlier in the chapter I described a technique for expanding the  training data by applying (small) rotations, skewing, and  translation.  Modify <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span> to incorporate all these  techniques.  <span class="html-tag">&lt;em&gt;</span>Note: Unless you have a tremendous amount of    memory, it is not practical to explicitly generate the entire    expanded data set.  So you should consider alternate approaches.<span class="html-tag">&lt;/em&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;li&gt;</span> Add the ability to load and save networks to <span class="html-tag">&lt;tt&gt;</span>network3.py<span class="html-tag">&lt;/tt&gt;</span>.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;li&gt;</span> A shortcoming of the current code is that it provides few  diagnostic tools.  Can you think of any diagnostics to add that  would make it easier to understand to what extent a network is  overfitting?  Add them.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;li&gt;</span> We've used the same initialization procedure for rectified  linear units as for sigmoid (and tanh) neurons.  Our  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#weight_initialization">chap3.html#weight_initialization</a>"&gt;</span>argument for that    initialization<span class="html-tag">&lt;/a&gt;</span> was specific to the sigmoid function.  Consider a  network made entirely of rectified linear units (including outputs).  Show that rescaling all the weights in the network by a constant  factor $c &gt; 0$ simply rescales the outputs by a factor $c$.  How  does this change if the final layer is a softmax?  What do you think  of using the sigmoid initialization procedure for the rectified  linear units?  Can you think of a better initialization procedure?  <span class="html-tag">&lt;em&gt;</span>Note: This is a very open-ended problem, not something with a    simple self-contained answer.  Still, considering the problem will    help you better understand networks containing rectified linear    units.<span class="html-tag">&lt;/em&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;li&gt;</span> Our  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap5.html#what's_causing_the_vanishing_gradient_problem_unstable_gradients_in_deep_neural_nets">chap5.html#what's_causing_the_vanishing_gradient_problem_unstable_gradients_in_deep_neural_nets</a>"&gt;</span>analysis<span class="html-tag">&lt;/a&gt;</span>  of the unstable gradient problem was for sigmoid neurons. How does  the analysis change for networks made up of rectified linear units?  Can you think of a good way of modifying such a network so it  doesn't suffer from the unstable gradient problem?  <span class="html-tag">&lt;em&gt;</span>Note: The    word good in the second part of this makes the problem a research    problem.  It's actually easy to think of ways of making such    modifications.  But I haven't investigated in enough depth to know    of a really good technique.<span class="html-tag">&lt;/em&gt;</span><span class="html-tag">&lt;/ul&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h3&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">recent_progress_in_image_recognition</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#recent_progress_in_image_recognition">#recent_progress_in_image_recognition</a>"&gt;</span>Recent progress in image recognition<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h3&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In 1998, the year MNIST was introduced, it took weeks to train astate-of-the-art workstation to achieve accuracies substantially worsethan those we can achieve using a GPU and less than an hour oftraining. Thus, MNIST is no longer a problem that pushes the limits ofavailable technique; rather, the speed of training means that it is aproblem good for teaching and learning purposes.  Meanwhile, the focusof research has moved on, and modern work involves much morechallenging image recognition problems.  In this section, I brieflydescribe some recent work on image recognition using neural networks.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The section is different to most of the book.  Through the book I'vefocused on ideas likely to be of lasting interest - ideas such asbackpropagation, regularization, and convolutional networks.  I'vetried to avoid results which are fashionable as I write, but whoselong-term value is unknown. In science, such results are more oftenthan not ephemera which fade and have little lasting impact.  Giventhis, a skeptic might say: "well, surely the recent progress in imagerecognition is an example of such ephemera?  In another two or threeyears, things will have moved on.  So surely these results are only ofinterest to a few specialists who want to compete at the absolutefrontier?  Why bother discussing it?"<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Such a skeptic is right that some of the finer details of recentpapers will gradually diminish in perceived importance.  With thatsaid, the past few years have seen extraordinary improvements usingdeep nets to attack extremely difficult image recognition tasks.Imagine a historian of science writing about computer vision in theyear 2100.  They will identify the years 2011 to 2015 (and probably afew years beyond) as a time of huge breakthroughs, driven by deepconvolutional nets.  That doesn't mean deep convolutional nets willstill be used in 2100, much less detailed ideas such as dropout,rectified linear units, and so on.  But it does mean that an importanttransition is taking place, right now, in the history of ideas.  It'sa bit like watching the discovery of the atom, or the invention ofantibiotics: invention and discovery on a historic scale.  And sowhile we won't dig down deep into details, it's worth getting someidea of the exciting discoveries currently being made.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>The 2012 LRMD paper:<span class="html-tag">&lt;/strong&gt;</span> Let me start with a 2012paper*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://research.google.com/pubs/pub38115.html">http://research.google.com/pubs/pub38115.html</a>"&gt;</span>Building    high-level features using large scale unsupervised learning<span class="html-tag">&lt;/a&gt;</span>, by  Quoc Le, Marc'Aurelio Ranzato, Rajat Monga, Matthieu Devin, Kai  Chen, Greg Corrado, Jeff Dean, and Andrew Ng (2012).  Note that the  detailed architecture of the network used in the paper differed in  many details from the deep convolutional networks we've been  studying.  Broadly speaking, however, LRMD is based on many similar  ideas.<span class="html-tag">&lt;/span&gt;</span>  from a group of researchers from Stanford and Google.  I'llrefer to this paper as LRMD, after the last names of the first fourauthors. LRMD used a neural network to classify images from<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.image-net.org/">http://www.image-net.org</a>"&gt;</span>ImageNet<span class="html-tag">&lt;/a&gt;</span>, a very challenging imagerecognition problem.  The 2011 ImageNet data that they used included16 million full color images, in 20 thousand categories.  The imageswere crawled from the open net, and classified by workers fromAmazon's Mechanical Turk service.  Here's a few ImageNetimages*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*These are from the 2014 dataset, which is somewhat  changed from 2011.  Qualitatively, however, the dataset is extremely  similar.  Details about ImageNet are available in the original  ImageNet paper,  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.image-net.org/papers/imagenet_cvpr09.pdf">http://www.image-net.org/papers/imagenet_cvpr09.pdf</a>"&gt;</span>ImageNet:    a large-scale hierarchical image database<span class="html-tag">&lt;/a&gt;</span>, by Jia Deng, Wei Dong,  Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei (2009).<span class="html-tag">&lt;/span&gt;</span>:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/imagenet1.jpg">images/imagenet1.jpg</a>" <span class="html-attribute-name">height</span>="<span class="html-attribute-value">120px</span>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/imagenet2.jpg">images/imagenet2.jpg</a>" <span class="html-attribute-name">height</span>="<span class="html-attribute-value">120px</span>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/imagenet3.jpg">images/imagenet3.jpg</a>" <span class="html-attribute-name">height</span>="<span class="html-attribute-value">120px</span>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/imagenet4.jpg">images/imagenet4.jpg</a>" <span class="html-attribute-name">height</span>="<span class="html-attribute-value">120px</span>"&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>These are, respectively, in the categories for beading plane, brownroot rot fungus, scalded milk, and the common roundworm.  If you'relooking for a challenge, I encourage you to visit ImageNet's list of<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.image-net.org/synset?wnid=n03489162">http://www.image-net.org/synset?wnid=n03489162</a>"&gt;</span>hand tools<span class="html-tag">&lt;/a&gt;</span>,which distinguishes between beading planes, block planes, chamferplanes, and about a dozen other types of plane, amongst othercategories.  I don't know about you, but I cannot confidentlydistinguish between all these tool types.  This is obviously a muchmore challenging image recognition task than MNIST!  LRMD's networkobtained a respectable $15.8$ percent accuracy for correctlyclassifying ImageNet images.  That may not sound impressive, but itwas a huge improvement over the previous best result of $9.3$ percentaccuracy.  That jump suggested that neural networks might offer apowerful approach to very challenging image recognition tasks, such asImageNet.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>The 2012 KSH paper:<span class="html-tag">&lt;/strong&gt;</span> The work of LRMD was followed by a 2012paper of Krizhevsky, Sutskever and Hinton(KSH)*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.cs.toronto.edu/~fritz/absps/imagenet.pdf">http://www.cs.toronto.edu/&amp;#126;fritz/absps/imagenet.pdf</a>"&gt;</span>ImageNet    classification with deep convolutional neural networks<span class="html-tag">&lt;/a&gt;</span>, by Alex  Krizhevsky, Ilya Sutskever, and Geoffrey E. Hinton (2012).<span class="html-tag">&lt;/span&gt;</span>. KSHtrained and tested a deep convolutional neural network using arestricted subset of the ImageNet data. The subset they used came froma popular machine learning competition - the ImageNet Large-ScaleVisual Recognition Challenge (ILSVRC).  Using a competition datasetgave them a good way of comparing their approach to other leadingtechniques.  The ILSVRC-2012 training set contained about 1.2 millionImageNet images, drawn from 1,000 categories.  The validation and testsets contained 50,000 and 150,000 images, respectively, drawn from thesame 1,000 categories.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>One difficulty in running the ILSVRC competition is that many ImageNetimages contain multiple objects.  Suppose an image shows a labradorretriever chasing a soccer ball.  The so-called "correct" ImageNetclassification of the image might be as a labrador retriever.  Shouldan algorithm be penalized if it labels the image as a soccer ball?Because of this ambiguity, an algorithm was considered correct if theactual ImageNet classification was among the $5$ classifications thealgorithm considered most likely.  By this top-$5$ criterion, KSH'sdeep convolutional network achieved an accuracy of $84.7$ percent,vastly better than the next-best contest entry, which achieved anaccuracy of $73.8$ percent.  Using the more restrictive metric ofgetting the label exactly right, KSH's network achieved an accuracy of$63.3$ percent.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>It's worth briefly describing KSH's network, since it has inspiredmuch subsequent work.  It's also, as we shall see, closely related tothe networks we trained earlier in this chapter, albeit moreelaborate.  KSH used a deep convolutional neural network, trained ontwo GPUs.  They used two GPUs because the particular type of GPU theywere using (an NVIDIA GeForce GTX 580) didn't have enough on-chipmemory to store their entire network.  So they split the network intotwo parts, partitioned across the two GPUs.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The KSH network has $7$ layers of hidden neurons.  The first $5$hidden layers are convolutional layers (some with max-pooling), whilethe next $2$ layers are fully-connected layers.  The ouput layer is a$1,000$-unit softmax layer, corresponding to the $1,000$ imageclasses. Here's a sketch of the network, taken from the KSHpaper*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*Thanks to Ilya Sutskever.<span class="html-tag">&lt;/span&gt;</span>.  The details are explainedbelow.  Note that many layers are split into $2$ parts, correspondingto the $2$ GPUs.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/KSH.jpg">images/KSH.jpg</a>" <span class="html-attribute-name">width</span>="<span class="html-attribute-value">600px</span>"&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The input layer contains $3 \times 224 \times 224$ neurons,representing the RGB values for a $224 \times 224$ image.  Recallthat, as mentioned earlier, ImageNet contains images of varyingresolution.  This poses a problem, since a neural network's inputlayer is usually of a fixed size.  KSH dealt with this by rescalingeach image so the shorter side had length $256$. They then cropped outa $256 \times 256$ area in the center of the rescaled image.  Finally,KSH extracted random $224 \times 224$ subimages (and horizontalreflections) from the $256 \times 256$ images.  They did this randomcropping as a way of expanding the training data, and thus reducingoverfitting.  This is particularly helpful in a large network such asKSH's.  It was these $224 \times 224$ images which were used as inputsto the network.  In most cases the cropped image still contains themain object from the uncropped image.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Moving on to the hidden layers in KSH's network, the first hiddenlayer is a convolutional layer, with a max-pooling step.  It useslocal receptive fields of size $11 \times 11$, and a stride length of$4$ pixels.  There are a total of $96$ feature maps.  The feature mapsare split into two groups of $48$ each, with the first $48$ featuremaps residing on one GPU, and the second $4$8 feature maps residing onthe other GPU.  The max-pooling in this and later layers is done in $3\times 3$ regions, but the pooling regions are allowed to overlap, andare just $2$ pixels apart.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The second hidden layer is also a convolutional layer, with amax-pooling step.  It uses $5 \times 5$ local receptive fields, andthere's a total of $256$ feature maps, split into $128$ on each GPU.Note that the feature maps only use $48$ input channels, not the full$96$ output from the previous layer (as would usually be the case).This is because any single feature map only uses inputs from the sameGPU.  In this sense the network departs from the convolutionalarchitecture we described earlier in the chapter, though obviously thebasic idea is still the same.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The third, fourth and fifth hidden layers are convolutional layers,but unlike the previous layers, they do not involve max-pooling.Their respectives parameters are: (3) $384$ feature maps, with $3\times 3$ local receptive fields, and $256$ input channels; (4) $384$feature maps, with $3 \times 3$ local receptive fields, and $192$input channels; and (5) $256$ feature maps, with $3 \times 3$ localreceptive fields, and $192$ input channels.  Note that the third layerinvolves some inter-GPU communication (as depicted in the figure) inorder that the feature maps use all $256$ input channels.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The sixth and seventh hidden layers are fully-connected layers, with$4,096$ neurons in each layer.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The output layer is a $1,000$-unit softmax layer.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The KSH network takes advantage of many techniques.  Instead of usingthe sigmoid or tanh activation functions, KSH use rectified linearunits, which sped up training significantly.  KSH's network hadroughly 60 million learned parameters, and was thus, even with thelarge training set, susceptible to overfitting.  To overcome this,they expanded the training set using the random cropping strategy wediscussed above.  They also further addressed overfitting by using avariant of <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#regularization">chap3.html#regularization</a>"&gt;</span>l2 regularization<span class="html-tag">&lt;/a&gt;</span>, and<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#other_techniques_for_regularization">chap3.html#other_techniques_for_regularization</a>"&gt;</span>dropout<span class="html-tag">&lt;/a&gt;</span>.The network itself was trained using<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap3.html#variations_on_stochastic_gradient_descent">chap3.html#variations_on_stochastic_gradient_descent</a>"&gt;</span>momentum-based<span class="html-tag">&lt;/a&gt;</span>mini-batch stochastic gradient descent.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>That's an overview of many of the core ideas in the KSH paper.  I'veomitted some details, for which you should look at the paper.  You canalso look at Alex Krizhevsky's<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://code.google.com/p/cuda-convnet/">https://code.google.com/p/cuda-convnet/</a>"&gt;</span>cuda-convnet<span class="html-tag">&lt;/a&gt;</span> (andsuccessors), which contains code implementing many of the ideas.  ATheano-based implementation has also beendeveloped*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1412.2302">http://arxiv.org/abs/1412.2302</a>"&gt;</span>Theano-based    large-scale visual recognition with multiple GPUs<span class="html-tag">&lt;/a&gt;</span>, by Weiguang  Ding, Ruoyan Wang, Fei Mao, and Graham Taylor (2014).<span class="html-tag">&lt;/span&gt;</span>, with thecode available<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://github.com/uoguelph-mlrg/theano_alexnet">https://github.com/uoguelph-mlrg/theano_alexnet</a>"&gt;</span>here<span class="html-tag">&lt;/a&gt;</span>.  Thecode is recognizably along similar lines to the developed in thischapter, although the use of multiple GPUs complicates thingssomewhat.  The Caffe neural nets framework also includes a version ofthe KSH network, see their<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://caffe.berkeleyvision.org/model_zoo.html">http://caffe.berkeleyvision.org/model_zoo.html</a>"&gt;</span>Model Zoo<span class="html-tag">&lt;/a&gt;</span> fordetails.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>The 2014 ILSVRC competition:<span class="html-tag">&lt;/strong&gt;</span> Since 2012, rapid progresscontinues to be made.  Consider the 2014 ILSVRC competition.  As in2012, it involved a training set of $1.2$ million images, in $1,000$categories, and the figure of merit was whether the top $5$predictions included the correct category.  The winning team, basedprimarily atGoogle*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1409.4842">http://arxiv.org/abs/1409.4842</a>"&gt;</span>Going deeper    with convolutions<span class="html-tag">&lt;/a&gt;</span>, by Christian Szegedy, Wei Liu, Yangqing Jia,  Pierre Sermanet, Scott Reed, Dragomir Anguelov, Dumitru Erhan,  Vincent Vanhoucke, and Andrew Rabinovich (2014).<span class="html-tag">&lt;/span&gt;</span>, used a deepconvolutional network with $22$ layers of neurons.  They called theirnetwork GoogLeNet, as a homage to LeNet-5.  GoogLeNet achieved a top-5accuracy of $93.33$ percent, a giant improvement over the 2013 winner(<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.clarifai.com/">http://www.clarifai.com</a>"&gt;</span>Clarifai<span class="html-tag">&lt;/a&gt;</span>, with $88.3$ percent), andthe 2012 winner (KSH, with $84.7$ percent).<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Just how good is GoogLeNet's $93.33$ percent accuracy?  In 2014 a teamof researchers wrote a survey paper about the ILSVRCcompetition*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1409.0575">http://arxiv.org/abs/1409.0575</a>"&gt;</span>ImageNet    large scale visual recognition challenge<span class="html-tag">&lt;/a&gt;</span>, by Olga Russakovsky,  Jia Deng, Hao Su, Jonathan Krause, Sanjeev Satheesh, Sean Ma,  Zhiheng Huang, Andrej Karpathy, Aditya Khosla, Michael Bernstein,  Alexander C. Berg, and Li Fei-Fei (2014).<span class="html-tag">&lt;/span&gt;</span>.  One of the questionsthey address is how well humans perform on ILSVRC.  To do this, theybuilt a system which lets humans classify ILSVRC images.  As one ofthe authors, Andrej Karpathy, explains in an informative<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://karpathy.github.io/2014/09/02/what-i-learned-from-competing-against-a-convnet-on-imagenet/">http://karpathy.github.io/2014/09/02/what-i-learned-from-competing-against-a-convnet-on-imagenet/</a>"&gt;</span>blog  post<span class="html-tag">&lt;/a&gt;</span>, it was a lot of trouble to get the humans up to GoogLeNet'sperformance:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;blockquote&gt;</span> ...the task of labeling images with 5 out of 1000  categories quickly turned out to be extremely challenging, even for  some friends in the lab who have been working on ILSVRC and its  classes for a while. First we thought we would put it up on [Amazon  Mechanical Turk]. Then we thought we could recruit paid  undergrads. Then I organized a labeling party of intense labeling  effort only among the (expert labelers) in our lab. Then I developed  a modified interface that used GoogLeNet predictions to prune the  number of categories from 1000 to only about 100. It was still too  hard - people kept missing categories and getting up to ranges of  13-15&amp;#37; error rates. In the end I realized that to get anywhere  competitively close to GoogLeNet, it was most efficient if I sat  down and went through the painfully long training process and the  subsequent careful annotation process myself... The labeling  happened at a rate of about 1 per minute, but this decreased over  time... Some images are easily recognized, while some images (such  as those of fine-grained breeds of dogs, birds, or monkeys) can  require multiple minutes of concentrated effort. I became very good  at identifying breeds of dogs... Based on the sample of images I  worked on, the GoogLeNet classification error turned out to be  6.8&amp;#37;... My own error in the end turned out to be 5.1&amp;#37;,  approximately 1.7&amp;#37; better.  <span class="html-tag">&lt;/blockquote&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>In other words, an expert human, working painstakingly, was with greateffort able to narrowly beat the deep neural network.  In fact,Karpathy reports that a second human expert, trained on a smallersample of images, was only able to attain a $12.0$ percent top-5 errorrate, significantly below GoogLeNet's performance.  About half theerrors were due to the expert "failing to spot and consider theground truth label as an option".<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>These are astonishing results.  Indeed, since this work, several teamshave reported systems whose top-5 error rate is actually <span class="html-tag">&lt;em&gt;</span>better<span class="html-tag">&lt;/em&gt;</span>than 5.1&amp;#37;.  This has sometimes been reported in the media as thesystems having better-than-human vision.  While the results aregenuinely exciting, there are many caveats that make it misleading tothink of the systems as having better-than-human vision.  The ILSVRCchallenge is in many ways a rather limited problem - a crawl of theopen web is not necessarily representative of images found inapplications!  And, of course, the top-$5$ criterion is quiteartificial.  We are still a long way from solving the problem of imagerecognition or, more broadly, computer vision.  Still, it's extremelyencouraging to see so much progress made on such a challengingproblem, over just a few years.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Other activity:<span class="html-tag">&lt;/strong&gt;</span> I've focused on ImageNet, but there's aconsiderable amount of other activity using neural nets to do imagerecognition.  Let me briefly describe a few interesting recentresults, just to give the flavour of some current work.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>One encouraging practical set of results comes from a team at Google,who applied deep convolutional networks to the problem of recognizingstreet numbers in Google's Street Viewimagery*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1312.6082">http://arxiv.org/abs/1312.6082</a>"&gt;</span>Multi-digit    Number Recognition from Street View Imagery using Deep    Convolutional Neural Networks<span class="html-tag">&lt;/a&gt;</span>, by Ian J. Goodfellow, Yaroslav  Bulatov, Julian Ibarz, Sacha Arnoud, and Vinay Shet (2013).<span class="html-tag">&lt;/span&gt;</span>.  Intheir paper, they report detecting and automatically transcribingnearly 100 million street numbers at an accuracy similar to that of ahuman operator.  The system is fast: their system transcribed all ofStreet View's images of street numbers in France in less that an hour!They say: "Having this new dataset significantly increased thegeocoding quality of Google Maps in several countries especially theones that did not already have other sources of good geocoding."  Andthey go on to make the broader claim: "We believe with this model wehave solved [optical character recognition] for short sequences [ofcharacters] for many applications."<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>I've perhaps given the impression that it's all a parade ofencouraging results.  Of course, some of the most interesting workreports on fundamental things we don't yet understand.  For instance,a 2013 paper*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1312.6199">http://arxiv.org/abs/1312.6199</a>"&gt;</span>Intriguing    properties of neural networks<span class="html-tag">&lt;/a&gt;</span>, by Christian Szegedy, Wojciech  Zaremba, Ilya Sutskever, Joan Bruna, Dumitru Erhan, Ian Goodfellow,  and Rob Fergus (2013)<span class="html-tag">&lt;/span&gt;</span> showed that deep networks may suffer fromwhat are effectively blind spots.  Consider the lines of images below.On the left is an ImageNet image classified correctly by theirnetwork.  On the right is a slightly perturbed image (the perturbationis in the middle) which is classified <span class="html-tag">&lt;em&gt;</span>incorrectly<span class="html-tag">&lt;/em&gt;</span> by thenetwork.  The authors found that there are such "adversarial" imagesfor every sample image, not just a few special ones.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/images/adversarial.jpg">images/adversarial.jpg</a>"&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>This is a disturbing result.  The paper used a network based on thesame code as KSH's network - that is, just the type of network thatis being increasingly widely used.  While such neural networks computefunctions which are, in principle, continuous, results like thissuggest that in practice they're likely to compute functions which arevery nearly discontinuous.  Worse, they'll be discontinuous in waysthat violate our intuition about what is reasonable behavior.  That'sconcerning.  Furthermore, it's not yet well understood what's causingthe discontinuity: is it something about the loss function?  Theactivation functions used?  The architecture of the network?Something else?  We don't yet know.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Now, these results are not quite as bad as they sound.  Although suchadversarial images are common, they're also unlikely in practice.  Asthe paper notes:<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;blockquote&gt;</span>  The existence of the adversarial negatives appears to be in  contradiction with the networks ability to achieve high  generalization performance. Indeed, if the network can generalize  well, how can it be confused by these adversarial negatives, which  are indistinguishable from the regular examples? The explanation is  that the set of adversarial negatives is of extremely low  probability, and thus is never (or rarely) observed in the test set,  yet it is dense (much like the rational numbers), and so it is found  near every virtually every test case.<span class="html-tag">&lt;/blockquote&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Nonetheless, it is distressing that we understand neural nets sopoorly that this kind of result should be a recent discovery.  Ofcourse, a major benefit of the results is that they have stimulatedmuch followup work.  For example, one recentpaper*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1412.1897">http://arxiv.org/abs/1412.1897</a>"&gt;</span>Deep Neural    Networks are Easily Fooled: High Confidence Predictions for    Unrecognizable Images<span class="html-tag">&lt;/a&gt;</span>, by Anh Nguyen, Jason Yosinski, and Jeff  Clune (2014).<span class="html-tag">&lt;/span&gt;</span> shows that given a trained network it's possible togenerate images which look to a human like white noise, but which thenetwork classifies as being in a known category with a very highdegree of confidence.  This is another demonstration that we have along way to go in understanding neural networks and their use in imagerecognition.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Despite results like this, the overall picture is encouraging.  We'reseeing rapid progress on extremely difficult benchmarks, likeImageNet.  We're also seeing rapid progress in the solution ofreal-world problems, like recognizing street numbers in StreetView.But while this is encouraging it's not enough just to see improvementson benchmarks, or even real-world applications.  There are fundamentalphenomena which we still understand poorly, such as the existence ofadversarial images.  When such fundamental problems are still beingdiscovered (never mind solved), it is premature to say that we're nearsolving the problem of image recognition.  At the same time suchproblems are an exciting stimulus to further work.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h3&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">other_approaches_to_deep_neural_nets</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#other_approaches_to_deep_neural_nets">#other_approaches_to_deep_neural_nets</a>"&gt;</span>Other approaches to deep neural nets<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h3&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Through this book, we've concentrated on a single problem: classifyingthe MNIST digits.  It's a juicy problem which forced us to understandmany powerful ideas: stochastic gradient descent, backpropagation,convolutional nets, regularization, and more.  But it's also a narrowproblem.  If you read the neural networks literature, you'll run intomany ideas we haven't discussed: recurrent neural networks, Boltzmannmachines, generative models, transfer learning, reinforcementlearning, and so on, on and on $\ldots$ and on!  Neural networks is avast field.  However, many important ideas are variations on ideaswe've already discussed, and can be understood with a little effort.In this section I provide a glimpse of these as yet unseen vistas.The discussion isn't detailed, nor comprehensive - that wouldgreatly expand the book.  Rather, it's impressionistic, an attempt toevoke the conceptual richness of the field, and to relate some ofthose riches to what we've already seen.  Through the section, I'llprovide a few links to other sources, as entrees to learn more.  Ofcourse, many of these links will soon be superseded, and you may wishto search out more recent literature.  That point notwithstanding, Iexpect many of the underlying ideas to be of lasting interest.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Recurrent neural networks (RNNs):<span class="html-tag">&lt;/strong&gt;</span> In the feedforward netswe've been using there is a single input which completely determinesthe activations of all the neurons through the remaining layers.  It'sa very static picture: everything in the network is fixed, with afrozen, crystalline quality to it.  But suppose we allow the elementsin the network to keep changing in a dynamic way.  For instance, thebehaviour of hidden neurons might not just be determined by theactivations in previous hidden layers, but also by the activations atearlier times.  Indeed, a neuron's activation might be determined inpart by its own activation at an earlier time.  That's certainly notwhat happens in a feedforward network.  Or perhaps the activations ofhidden and output neurons won't be determined just by the currentinput to the network, but also by earlier inputs.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Neural networks with this kind of time-vaying behaviour are known as<span class="html-tag">&lt;em&gt;</span>recurrent neural networks<span class="html-tag">&lt;/em&gt;</span> or <span class="html-tag">&lt;em&gt;</span>RNNs<span class="html-tag">&lt;/em&gt;</span>.  There are manydifferent ways of mathematically formalizing the informal descriptionof recurrent nets given in the last paragraph.  You can get theflavour of some of these mathematical models by glancing at<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://en.wikipedia.org/wiki/Recurrent_neural_network">http://en.wikipedia.org/wiki/Recurrent_neural_network</a>"&gt;</span>the  Wikipedia article on RNNs<span class="html-tag">&lt;/a&gt;</span>.  As I write, that page lists no fewerthan 13 different models.  But mathematical details aside, the broadidea is that RNNs are neural networks in which there is some notion ofdynamic change over time.  And, not surprisingly, they're particularlyuseful in analysing data or processes that change over time.  Suchdata and processes arise naturally in problems such as speech ornatural language, for example.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>One way RNNs are currently being used is to connect neural networksmore closely to traditional ways of thinking about algorithms, ways ofthinking based on concepts such as Turing machines and (conventional)programming languages.  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1410.4615">http://arxiv.org/abs/1410.4615</a>"&gt;</span>A 2014  paper<span class="html-tag">&lt;/a&gt;</span> developed an RNN which could take as input acharacter-by-character description of a (very, very simple!) Pythonprogram, and use that description to predict the output.  Informally,the network is learning to "understand" certain Python programs.<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1410.5401">http://arxiv.org/abs/1410.5401</a>"&gt;</span>A second paper, also from 2014<span class="html-tag">&lt;/a&gt;</span>,used RNNs as a starting point to develop what they called a neuralTuring machine (NTM).  This is a universal computer whose entirestructure can be trained using gradient descent.  They trained theirNTM to infer algorithms for several simple problems, such as sortingand copying.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>As it stands, these are extremely simple toy models.  Learning toexecute the Python program <span class="html-tag">&lt;tt&gt;</span>print(398345+42598)<span class="html-tag">&lt;/tt&gt;</span> doesn't make anetwork into a full-fledged Python interpreter!  It's not clear howmuch further it will be possible to push the ideas.  Still, theresults are intriguing.  Historically, neural networks have done wellat pattern recognition problems where conventional algorithmicapproaches have trouble.  Vice versa, conventional algorithmicapproaches are good at solving problems that neural nets aren't sogood at.  No-one today implements a web server or a database programusing a neural network!  It'd be great to develop unified models thatintegrate the strengths of both neural networks and more traditionalapproaches to algorithms.  RNNs and ideas inspired by RNNs may help usdo that.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>RNNs have also been used in recent years to attack many otherproblems.  They've been particularly useful in speech recognition.Approaches based on RNNs have, for example,<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1303.5778">http://arxiv.org/abs/1303.5778</a>"&gt;</span>set records for the accuracy of  phoneme recognition<span class="html-tag">&lt;/a&gt;</span>.  They've also been used to develop<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.fit.vutbr.cz/~imikolov/rnnlm/thesis.pdf">http://www.fit.vutbr.cz/&amp;#126;imikolov/rnnlm/thesis.pdf</a>"&gt;</span>improved  models of the language people use while speaking<span class="html-tag">&lt;/a&gt;</span>.  Better languagemodels help disambiguate utterances that otherwise sound alike.  Agood language model will, for example, tell us that "to infinity andbeyond" is much more likely than "two infinity and beyond", despitethe fact that the phrases sound identical.  RNNs have been used to setnew records for certain language benchmarks.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>This work is, incidentally, part of a broader use of deep neural netsof all types, not just RNNs, in speech recognition.  For example, anapproach based on deep nets has achieved<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1309.1501">http://arxiv.org/abs/1309.1501</a>"&gt;</span>outstanding results on large  vocabulary continuous speech recognition<span class="html-tag">&lt;/a&gt;</span>.  And another system basedon deep nets has been deployed in<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.wired.com/2013/02/android-neural-network/">http://www.wired.com/2013/02/android-neural-network/</a>"&gt;</span>Google's  Android operating system<span class="html-tag">&lt;/a&gt;</span> (for related technical work, see<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://research.google.com/pubs/VincentVanhoucke.html">http://research.google.com/pubs/VincentVanhoucke.html</a>"&gt;</span>Vincent  Vanhoucke's 2012-2015 papers<span class="html-tag">&lt;/a&gt;</span>).<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>I've said a little about what RNNs can do, but not so much about howthey work.  It perhaps won't surprise you to learn that many of theideas used in feedforward networks can also be used in RNNs.  Inparticular, we can train RNNs using straightforward modifications togradient descent and backpropagation.  Many other ideas used infeedforward nets, ranging from regularization techniques toconvolutions to the activation and cost functions used, are alsouseful in recurrent nets.  And so many of the techniques we'vedeveloped in the book can be adapted for use with RNNs.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Long short-term memory units (LSTMs):<span class="html-tag">&lt;/strong&gt;</span> One challenge affectingRNNs is that early models turned out to be very difficult to train,harder even than deep feedforward networks.  The reason is theunstable gradient problem discussed in <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap5.html">chap5.html</a>"&gt;</span>Chapter 5<span class="html-tag">&lt;/a&gt;</span>.Recall that the usual manifestation of this problem is that thegradient gets smaller and smaller as it is propagated back throughlayers.  This makes learning in early layers extremely slow.  Theproblem actually gets worse in RNNs, since gradients aren't justpropagated backward through layers, they're propagated backwardthrough time.  If the network runs for a long time that can make thegradient extremely unstable and hard to learn from.  Fortunately, it'spossible to incorporate an idea known as long short-term memory units(LSTMs) into RNNs.  The units were introduced by<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://dx.doi.org/10.1162/neco.1997.9.8.1735">http://dx.doi.org/10.1162/neco.1997.9.8.1735</a>"&gt;</span>Hochreiter and  Schmidhuber in 1997<span class="html-tag">&lt;/a&gt;</span> with the explicit purpose of helping addressthe unstable gradient problem.  LSTMs make it much easier to get goodresults when training RNNs, and many recent papers (including manythat I linked above) make use of LSTMs or related ideas.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Deep belief nets, generative models, and Boltzmann machines:<span class="html-tag">&lt;/strong&gt;</span>Modern interest in deep learning began in 2006, with papers explaininghow to train a type of neural network known as a <span class="html-tag">&lt;em&gt;</span>deep belief  network<span class="html-tag">&lt;/em&gt;</span> (DBN)*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*See  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.cs.toronto.edu/~hinton/absps/fastnc.pdf">http://www.cs.toronto.edu/&amp;#126;hinton/absps/fastnc.pdf</a>"&gt;</span>A fast    learning algorithm for deep belief nets<span class="html-tag">&lt;/a&gt;</span>, by Geoffrey Hinton,  Simon Osindero, and Yee-Whye Teh (2006), as well as the related work  in  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.sciencemag.org/content/313/5786/504.short">http://www.sciencemag.org/content/313/5786/504.short</a>"&gt;</span>Reducing    the dimensionality of data with neural networks<span class="html-tag">&lt;/a&gt;</span>, by Geoffrey  Hinton and Ruslan Salakhutdinov (2006).<span class="html-tag">&lt;/span&gt;</span>.  DBNs were influential forseveral years, but have since lessened in popularity, while modelssuch as feedforward networks and recurrent neural nets have becomefashionable.  Despite this, DBNs have several properties that makethem interesting.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>One reason DBNs are interesting is that they're an example of what'scalled a <span class="html-tag">&lt;em&gt;</span>generative model<span class="html-tag">&lt;/em&gt;</span>.  In a feedforward network, wespecify the input activations, and they determine the activations ofthe feature neurons later in the network.  A generative model like aDBN can be used in a similar way, but it's also possible to specifythe values of some of the feature neurons and then "run the networkbackward", generating values for the input activations.  Moreconcretely, a DBN trained on images of handwritten digits can(potentially, and with some care) also be used to generate images thatlook like handwritten digits.  In other words, the DBN would in somesense be learning to write.  In this, a generative model is much likethe human brain: not only can it read digits, it can also write them.In Geoffrey Hinton's memorable phrase,<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.sciencedirect.com/science/article/pii/S0079612306650346">http://www.sciencedirect.com/science/article/pii/S0079612306650346</a>"&gt;</span>to  recognize shapes, first learn to generate images<span class="html-tag">&lt;/a&gt;</span>.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>A second reason DBNs are interesting is that they can do unsupervisedand semi-supervised learning.  For instance, when trained with imagedata, DBNs can learn useful features for understanding other images,even if the training images are unlabelled.  And the ability to dounsupervised learning is extremely interesting both for fundamentalscientific reasons, and - if it can be made to work well enough -for practical applications.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Given these attractive features, why have DBNs lessened in popularityas models for deep learning?  Part of the reason is that models suchas feedforward and recurrent nets have achieved many spectacularresults, such as their breakthroughs on image and speech recognitionbenchmarks.  It's not surprising and quite right that there's now lotsof attention being paid to these models.  There's an unfortunatecorollary, however.  The marketplace of ideas often functions in awinner-take-all fashion, with nearly all attention going to thecurrent fashion-of-the-moment in any given area.  It can becomeextremely difficult for people to work on momentarily unfashionableideas, even when those ideas are obviously of real long-term interest.My personal opinion is that DBNs and other generative models likelydeserve more attention than they are currently receiving.  And I won'tbe surprised if DBNs or a related model one day surpass the currentlyfashionable models.  For an introduction to DBNs, see<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.scholarpedia.org/article/Deep_belief_networks">http://www.scholarpedia.org/article/Deep_belief_networks</a>"&gt;</span>this  overview<span class="html-tag">&lt;/a&gt;</span>.  I've also found<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.cs.toronto.edu/~hinton/absps/guideTR.pdf">http://www.cs.toronto.edu/&amp;#126;hinton/absps/guideTR.pdf</a>"&gt;</span>this  article<span class="html-tag">&lt;/a&gt;</span> helpful.  It isn't primarily about deep belief nets,<span class="html-tag">&lt;em&gt;</span>per se<span class="html-tag">&lt;/em&gt;</span>, but does contain much useful information aboutrestricted Boltzmann machines, which are a key component of DBNs.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Other ideas:<span class="html-tag">&lt;/strong&gt;</span> What else is going on in neural networks anddeep learning?  Well, there's a huge amount of other fascinating work.Active areas of research include using neural networks to do<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://machinelearning.org/archive/icml2008/papers/391.pdf">http://machinelearning.org/archive/icml2008/papers/391.pdf</a>"&gt;</span>natural  language processing<span class="html-tag">&lt;/a&gt;</span> (see <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1103.0398">http://arxiv.org/abs/1103.0398</a>"&gt;</span>also  this informative review paper<span class="html-tag">&lt;/a&gt;</span>),<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://papers.nips.cc/paper/5346-information-based-learning-by-agents-in-unbounded-state-spaces">http://papers.nips.cc/paper/5346-information-based-learning-by-agents-in-unbounded-state-spaces</a>"&gt;</span>machine  translation<span class="html-tag">&lt;/a&gt;</span>, as well as perhaps more surprising applications suchas<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://yann.lecun.com/exdb/publis/pdf/humphrey-jiis-13.pdf">http://yann.lecun.com/exdb/publis/pdf/humphrey-jiis-13.pdf</a>"&gt;</span>music  informatics<span class="html-tag">&lt;/a&gt;</span>.  There are, of course, many other areas too.  In manycases, having read this book you should be able to begin followingrecent work, although (of course) you'll need to fill in gaps inpresumed background knowledge.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Let me finish this section by mentioning a particularly fun paper.  Itcombines deep convolutional networks with a technique known asreinforcement learning in order to learn to<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.cs.toronto.edu/~vmnih/docs/dqn.pdf">http://www.cs.toronto.edu/&amp;#126;vmnih/docs/dqn.pdf</a>"&gt;</span>play video games  well<span class="html-tag">&lt;/a&gt;</span> (see also<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.nature.com/nature/journal/v518/n7540/abs/nature14236.html">http://www.nature.com/nature/journal/v518/n7540/abs/nature14236.html</a>"&gt;</span>this  followup<span class="html-tag">&lt;/a&gt;</span>).  The idea is to use the convolutional network tosimplify the pixel data from the game screen, turning it into asimpler set of features, which can be used to decide which action totake: "go left", "go down", "fire", and so on.  What isparticularly interesting is that a single network learned to playseven different classic video games pretty well, outperforming humanexperts on three of the games.  Now, this all sounds like a stunt, andthere's no doubt the paper was well marketed, with the title "PlayingAtari with reinforcement learning".  But looking past the surfacegloss, consider that this system is taking raw pixel data - itdoesn't even know the game rules! - and from that data learning todo high-quality decision-making in several very different and veryadversarial environments, each with its own complex set of rules.That's pretty neat.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span> <span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;h3&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">on_the_future_of_neural_networks</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/chap6.html#on_the_future_of_neural_networks">#on_the_future_of_neural_networks</a>"&gt;</span>On the future of neural networks<span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/h3&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Intention-driven user interfaces:<span class="html-tag">&lt;/strong&gt;</span> There's an old joke inwhich an impatient professor tells a confused student: "don't listento what I say; listen to what I <span class="html-tag">&lt;em&gt;</span>mean<span class="html-tag">&lt;/em&gt;</span>".  Historically,computers have often been, like the confused student, in the darkabout what their users mean.  But this is changing.  I still remembermy surprise the first time I misspelled a Google search query, only tohave Google say "Did you mean [corrected query]?" and to offer thecorresponding search results.  Google CEO Larry Page<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://googleblog.blogspot.ca/2012/08/building-search-engine-of-future-one.html">http://googleblog.blogspot.ca/2012/08/building-search-engine-of-future-one.html</a>"&gt;</span>once  described the perfect search engine as understanding exactly what  [your queries] mean and giving you back exactly what you want<span class="html-tag">&lt;/a&gt;</span>.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>This is a vision of an <span class="html-tag">&lt;em&gt;</span>intention-driven user interface<span class="html-tag">&lt;/em&gt;</span>.  Inthis vision, instead of responding to users' literal queries, searchwill use machine learning to take vague user input, discern preciselywhat was meant, and take action on the basis of those insights.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>The idea of intention-driven interfaces can be applied far morebroadly than search.  Over the next few decades, thousands ofcompanies will build products which use machine learning to make userinterfaces that can tolerate imprecision, while discerning and actingon the user's true intent.  We're already seeing early examples ofsuch intention-driven interfaces: Apple's Siri; Wolfram Alpha; IBM'sWatson; systems which can<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://arxiv.org/abs/1411.4555">http://arxiv.org/abs/1411.4555</a>"&gt;</span>annotate photos and videos<span class="html-tag">&lt;/a&gt;</span>; andmuch more.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Most of these products will fail. Inspired user interface design ishard, and I expect many companies will take powerful machine learningtecnology and use it to build insipid user interfaces.  The bestmachine learning in the world won't help if your user interfaceconcept stinks.  But there will be a residue of products whichsucceed.  Over time that will cause a profound change in how we relateto computers.  Not so long ago - let's say, 2005 - users took itfor granted that they needed precision in most interactions withcomputers.  Indeed, computer literacy to a great extent meantinternalizing the idea that computers are extremely literal; a singlemisplaced semi-colon may completely change the nature of aninteraction with a computer.  But over the next few decades I expectwe'll develop many successful intention-driven user interfaces, andthat will dramatically change what we expect when interacting withcomputers.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Machine learning, data science, and the virtuous circle of  innovation:<span class="html-tag">&lt;/strong&gt;</span> Of course, machine learning isn't just being used tobuild intention-driven interfaces.  Another notable application is indata science, where machine learning is used to find the "knownunknowns" hidden in data.  This is already a fashionable area, andmuch has been written about it, so I won't say much.  But I do want tomention one consequence of this fashion that is not so often remarked:over the long run it's possible the biggest breakthrough in machinelearning won't be any single conceptual breakthrough. Rather, thebiggest breakthrough will be that machine learning research becomesprofitable, through applications to data science and other areas.  Ifa company can invest 1 dollar in machine learning research and get 1dollar and 10 cents back reasonably rapidly, then a lot of money willend up in machine learning research.  Put another way, machinelearning is an engine driving the creation of several major newmarkets and areas of growth in technology. The result will be largeteams of people with deep subject expertise, and with access toextraordinary resources.  That will propel machine learning furtherforward, creating more markets and opportunities, a virtuous circle ofinnovation.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>The role of neural networks and deep learning:<span class="html-tag">&lt;/strong&gt;</span> I've beentalking broadly about machine learning as a creator of newopportunities for technology.  What will be the specific role ofneural networks and deep learning in all this?<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>To answer the question, it helps to look at history.  Back in the1980s there was a great deal of excitement and optimism about neuralnetworks, especially after backpropagation became widely known.  Thatexcitement faded, and in the 1990s the machine learning baton passedto other techniques, such as support vector machines.  Today, neuralnetworks are again riding high, setting all sorts of records,defeating all comers on many problems.  But who is to say thattomorrow some new approach won't be developed that sweeps neuralnetworks away again?  Or perhaps progress with neural networks willstagnate, and nothing will immediately arise to take their place?<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>For this reason, it's much easier to think broadly about the future ofmachine learning than about neural networks specifically.  Part of theproblem is that we understand neural networks so poorly.  Why is itthat neural networks can generalize so well?  How is it that theyavoid overfitting as well as they do, given the very large number ofparameters they learn?  Why is it that stochastic gradient descentworks as well as it does?  How well will neural networks perform asdata sets are scaled?  For instance, if ImageNet was expanded by afactor of $10$, would neural networks' performance improve more orless than other machine learning techniques?  These are all simple,fundamental questions.  And, at present, we understand the answers tothese questions very poorly.  While that's the case, it's difficult tosay what role neural networks will play in the future of machinelearning.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>I will make one prediction: I believe deep learning is here to stay.The ability to learn hierarchies of concepts, building up multiplelayers of abstraction, seems to be fundamental to making sense of theworld.  This doesn't mean tomorrow's deep learners won't be radicallydifferent than today's.  We could see major changes in the constituentunits used, in the architectures, or in the learning algorithms.Those changes may be dramatic enough that we no longer think of theresulting systems as neural networks.  But they'd still be doing deeplearning.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;a <span class="html-attribute-name">name</span>="<span class="html-attribute-value">AI</span>"&gt;</span><span class="html-tag">&lt;/a&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;strong&gt;</span>Will neural networks and deep learning soon lead to artificial  intelligence?<span class="html-tag">&lt;/strong&gt;</span>  In this book we've focused on using neural nets todo specific tasks, such as classifying images.  Let's broaden ourambitions, and ask: what about general-purpose thinking computers?Can neural networks and deep learning help us solve the problem of(general) artificial intelligence (AI)?  And, if so, given the rapidrecent progress of deep learning, can we expect general AI any timesoon?<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Addressing these questions comprehensively would take a separate book.Instead, let me offer one observation.  It's based on an idea known as<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://en.wikipedia.org/wiki/Conway%27s_law">http://en.wikipedia.org/wiki/Conway%27s_law</a>"&gt;</span>Conway's law<span class="html-tag">&lt;/a&gt;</span>:<span class="html-tag">&lt;blockquote&gt;</span>  Any organization that designs a system... will inevitably produce a  design whose structure is a copy of the organization's communication  structure.<span class="html-tag">&lt;/blockquote&gt;</span> So, for example, Conway's law suggests that the design of a Boeing 747aircraft will mirror the extended organizational structure of Boeingand its contractors at the time the 747 was designed.  Or for asimple, specific example, consider a company building a complexsoftware application.  If the application's dashboard is supposed tobe integrated with some machine learning algorithm, the personbuilding the dashboard better be talking to the company's machinelearning expert.  Conway's law is merely that observation, writ large.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Upon first hearing Conway's law, many people respond either "Well,isn't that banal and obvious?" or "Isn't that wrong?"  Let me startwith the objection that it's wrong.  As an instance of this objection,consider the question: where does Boeing's accounting department showup in the design of the 747?  What about their janitorial department?Their internal catering?  And the answer is that these parts of theorganization probably don't show up explicitly anywhere in the 747.So we should understand Conway's law as referring only to those partsof an organization concerned explicitly with design and engineering.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>What about the other objection, that Conway's law is banal andobvious?  This may perhaps be true, but I don't think so, fororganizations too often act with disregard for Conway's law.  Teamsbuilding new products are often bloated with legacy hires or,contrariwise, lack a person with some crucial expertise.  Think of allthe products which have useless complicating features.  Or think ofall the products which have obvious major deficiences - e.g., aterrible user interface.  Problems in both classes are often caused bya mismatch between the team that was needed to produce a good product,and the team that was actually assembled.  Conway's law may beobvious, but that doesn't mean people don't routinely ignore it.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Conway's law applies to the design and engineering of systems where westart out with a pretty good understanding of the likely constituentparts, and how to build them.  It can't be applied directly to thedevelopment of artificial intelligence, because AI isn't (yet) such aproblem: we don't know what the constituent parts are.  Indeed, we'renot even sure what basic questions to be asking.  In others words, atthis point AI is more a problem of science than of engineering.Imagine beginning the design of the 747 without knowing about jetengines or the principles of aerodynamics.  You wouldn't know whatkinds of experts to hire into your organization.  As Werner von Braunput it, "basic research is what I'm doing when I don't know what I'mdoing".  Is there a version of Conway's law that applies to problemswhich are more science than engineering?<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>To gain insight into this question, consider the history of medicine.In the early days, medicine was the domain of practitioners like Galenand Hippocrates, who studied the entire body.  But as our knowledgegrew, people were forced to specialize.  We discovered many deep newideas*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*My apologies for overloading "deep".  I won't define  "deep ideas" precisely, but loosely I mean the kind of idea which  is the basis for a rich field of enquiry.  The backpropagation  algorithm and the germ theory of disease are both good examples.<span class="html-tag">&lt;/span&gt;</span>:think of things like the germ theory of disease, for instance, or theunderstanding of how antibodies work, or the understanding that theheart, lungs, veins and arteries form a complete caridovascularsystem.  Such deep insights formed the basis for subfields such asepidemiology, immunology, and the cluster of inter-linked fieldsaround the cardiovascular system.  And so the structure of ourknowledge has shaped the social structure of medicine.  This isparticularly striking in the case of immunology: realizing the immunesystem exists and is a system worthy of study is an extremelynon-trivial insight.  So we have an entire field of medicine - withspecialists, conferences, even prizes, and so on - organized aroundsomething which is not just invisible, it's arguably not a distinctthing at all.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>This is a common pattern that has been repeated in manywell-established sciences: not just medicine, but physics,mathematics, chemistry, and others.  The fields start out monolithic,with just a few deep ideas.  Early experts can master all those ideas.But as time passes that monolithic character changes.  We discovermany deep new ideas, too many for any one person to really master.  Asa result, the social structure of the field re-organizes and dividesaround those ideas.  Instead of a monolith, we have fields withinfields within fields, a complex, recursive, self-referential socialstructure, whose organization mirrors the connections between ourdeepest insights.  <span class="html-tag">&lt;em&gt;</span>And so the structure of our knowledge shapes  the social organization of science.  But that social shape in turn  constrains and helps determine what we can discover.<span class="html-tag">&lt;/em&gt;</span>  This is the  scientific analogue of Conway's law. <span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>So what's this got to do with deep learning or AI?<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>Well, since the early days of AI there have been arguments about itthat go, on one side, "Hey, it's not going to be so hard, we've got[super-special weapon] on our side", countered by "[super-specialweapon] won't be enough".  Deep learning is the latest super-specialweapon I've heard used in such arguments*<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">marginnote</span>"&gt;</span>*Interestingly, often  not by leading experts in deep learning, who have been quite  restrained.  See, for example, this  <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://www.facebook.com/yann.lecun/posts/10152348155137143">https://www.facebook.com/yann.lecun/posts/10152348155137143</a>"&gt;</span>thoughtful    post<span class="html-tag">&lt;/a&gt;</span> by Yann LeCun. This is a difference from many earlier  incarnations of the argument.<span class="html-tag">&lt;/span&gt;</span>; earlier versions of the argumentused logic, or Prolog, or expert systems, or whatever the mostpowerful technique of the day was.  The problem with such arguments isthat they don't give you any good way of saying just how powerful anygiven candidate super-special weapon is.  Of course, we've just spenta chapter reviewing evidence that deep learning can solve extremelychallenging problems.  It certainly looks very exciting and promising.But that was also true of systems like Prolog or<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://en.wikipedia.org/wiki/Eurisko">http://en.wikipedia.org/wiki/Eurisko</a>"&gt;</span>Eurisko<span class="html-tag">&lt;/a&gt;</span> or expert systemsin their day.  And so the mere fact that a set of ideas looks verypromising doesn't mean much.  How can we tell if deep learning istruly different from these earlier ideas?  Is there some way ofmeasuring how powerful and promising a set of ideas is?  Conway's lawsuggests that as a rough and heuristic proxy metric we can evaluatethe complexity of the social structure associated to those ideas.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>So, there are two questions to ask.  First, how powerful a set ofideas are associated to deep learning, according to this metric ofsocial complexity?  Second, how powerful a theory will we need, inorder to be able to build a general artificial intelligence?<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>As to the first question: when we look at deep learning today, it's anexciting and fast-paced but also relatively monolithic field.  Thereare a few deep ideas, and a few main conferences, with substantialoverlap between several of the conferences.  And there is paper afterpaper leveraging the same basic set of ideas: using stochasticgradient descent (or a close variation) to optimize a cost function.It's fantastic those ideas are so successful.  But what we don't yetsee is lots of well-developed subfields, each exploring their own setsof deep ideas, pushing deep learning in many directions.  And so,according to the metric of social complexity, deep learning is, ifyou'll forgive the play on words, still a rather shallow field.  It'sstill possible for one person to master most of the deepest ideas inthe field.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>On the second question: how complex and powerful a set of ideas willbe needed to obtain AI?  Of course, the answer to this question is:no-one knows for sure.  But in the <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://neuralnetworksanddeeplearning.com/app.html">app.html</a>"&gt;</span>appendix<span class="html-tag">&lt;/a&gt;</span> I examinesome of the existing evidence on this question.  I conclude that, evenrather optimistically, it's going to take many, many deep ideas tobuild an AI.  And so Conway's law suggests that to get to such a pointwe will necessarily see the emergence of many interrelatingdisciplines, with a complex and surprising stucture mirroring thestructure in our deepest insights.  We don't yet see this rich socialstructure in the use of neural networks and deep learning.  And so, Ibelieve that we are several decades (at least) from using deeplearning to develop general AI.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span>I've gone to a lot of trouble to construct an argument which istentative, perhaps seems rather obvious, and which has an indefiniteconclusion.  This will no doubt frustrate people who crave certainty.Reading around online, I see many people who loudly assert verydefinite, very strongly held opinions about AI, often on the basis offlimsy reasoning and non-existent evidence.  My frank opinion is this:it's too early to say.  As the old joke goes, if you ask a scientisthow far away some discovery is and they say "10 years" (or more),what they mean is "I've got no idea".  AI, like controlled fusionand a few other technologies, has been 10 years away for 60 plusyears.  On the flipside, what we definitely do have in deep learningis a powerful technique whose limits have not yet been found, and manywide-open fundamental problems.  That's an exciting creativeopportunity.<span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/p&gt;</span><span class="html-tag">&lt;p&gt;</span><span class="html-tag">&lt;/div&gt;</span><span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">footer</span>"&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">left_footer</span>"&gt;</span> In academic work,</td></tr><tr><td class="line-number" value="720"></td><td class="line-content">please cite this book as: Michael A. Nielsen, "Neural Networks and</td></tr><tr><td class="line-number" value="721"></td><td class="line-content">Deep Learning", Determination Press, 2015</td></tr><tr><td class="line-number" value="722"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="723"></td><td class="line-content"><span class="html-tag">&lt;br/&gt;</span></td></tr><tr><td class="line-number" value="724"></td><td class="line-content"><span class="html-tag">&lt;br/&gt;</span></td></tr><tr><td class="line-number" value="725"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="726"></td><td class="line-content">This work is licensed under a <span class="html-tag">&lt;a <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">license</span>"</span></td></tr><tr><td class="line-number" value="727"></td><td class="line-content"><span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB">http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB</a>"</td></tr><tr><td class="line-number" value="728"></td><td class="line-content"><span class="html-attribute-name">style</span>="<span class="html-attribute-value">color: #eee;</span>"&gt;Creative Commons Attribution-NonCommercial 3.0</td></tr><tr><td class="line-number" value="729"></td><td class="line-content">Unported License<span class="html-tag">&lt;/a&gt;</span>.  This means you're free to copy, share, and</td></tr><tr><td class="line-number" value="730"></td><td class="line-content">build on this book, but not to sell it.  If you're interested in</td></tr><tr><td class="line-number" value="731"></td><td class="line-content">commercial use, please <span class="html-tag">&lt;a</span></td></tr><tr><td class="line-number" value="732"></td><td class="line-content"><span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="mailto:mn@michaelnielsen.org">mailto:mn@michaelnielsen.org</a>"&gt;contact me<span class="html-tag">&lt;/a&gt;</span>.</td></tr><tr><td class="line-number" value="733"></td><td class="line-content"><span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="734"></td><td class="line-content"><span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">right_footer</span>"&gt;</span></td></tr><tr><td class="line-number" value="735"></td><td class="line-content">Last update: Sun Jul 26 11:06:00 2015</td></tr><tr><td class="line-number" value="736"></td><td class="line-content"><span class="html-tag">&lt;br/&gt;</span></td></tr><tr><td class="line-number" value="737"></td><td class="line-content"><span class="html-tag">&lt;br/&gt;</span></td></tr><tr><td class="line-number" value="738"></td><td class="line-content"><span class="html-tag">&lt;br/&gt;</span></td></tr><tr><td class="line-number" value="739"></td><td class="line-content"><span class="html-tag">&lt;a <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">license</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB">http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB</a>"&gt;</span><span class="html-tag">&lt;img <span class="html-attribute-name">alt</span>="<span class="html-attribute-value">Creative Commons Licence</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">border-width:0</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://i.creativecommons.org/l/by-nc/3.0/88x31.png">http://i.creativecommons.org/l/by-nc/3.0/88x31.png</a>" /&gt;</span><span class="html-tag">&lt;/a&gt;</span></td></tr><tr><td class="line-number" value="740"></td><td class="line-content"><span class="html-tag">&lt;/span&gt;</span></td></tr><tr><td class="line-number" value="741"></td><td class="line-content"><span class="html-tag">&lt;/div&gt;</span></td></tr><tr><td class="line-number" value="742"></td><td class="line-content"><span class="html-tag">&lt;script&gt;</span></td></tr><tr><td class="line-number" value="743"></td><td class="line-content">  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){</td></tr><tr><td class="line-number" value="744"></td><td class="line-content">  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),</td></tr><tr><td class="line-number" value="745"></td><td class="line-content">  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)</td></tr><tr><td class="line-number" value="746"></td><td class="line-content">  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');</td></tr><tr><td class="line-number" value="747"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="748"></td><td class="line-content">  ga('create', 'UA-44208967-1', 'neuralnetworksanddeeplearning.com');</td></tr><tr><td class="line-number" value="749"></td><td class="line-content">  ga('send', 'pageview');</td></tr><tr><td class="line-number" value="750"></td><td class="line-content"><br></td></tr><tr><td class="line-number" value="751"></td><td class="line-content"><span class="html-tag">&lt;/script&gt;</span></td></tr><tr><td class="line-number" value="752"></td><td class="line-content"><span class="html-tag">&lt;/body&gt;</span></td></tr><tr><td class="line-number" value="753"></td><td class="line-content"><span class="html-tag">&lt;/html&gt;</span><span class="html-end-of-file"></span></td></tr></tbody></table></body></html>